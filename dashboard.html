<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link
      rel="shortcut icon"
      href="assets/img/UN_Habitat_Icon.svg"
      type="image/x-icon"
    />
    <title>Dashboard</title>
    <!-- Simplified Arabic Font -->
    <link href="libraries/css/noto-naskh-arabic.css" rel="stylesheet" />
    <!-- Font Awesome Icons -->
    <link href="libraries/css/fontawesome-6.5.1.min.css" rel="stylesheet" />
    <!-- CSS Files -->
    <link
      id="pagestyle"
      href="assets/css/soft-ui-dashboard.css?v=1.1.0"
      rel="stylesheet"
    />
    <link href="libraries/css/bootstrap-5.3.3-rtl.min.css" rel="stylesheet" />
    <link
      href="libraries/css/bootstrap-icons-1.10.5.min.css"
      rel="stylesheet"
    />
    <script src="libraries/js/chart-4.4.1.umd.min.js"></script>

    <!-- jQuery and DataTables (offline local) -->
    <script src="assets/js/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="assets/css/dataTables.bootstrap5.min.css" />
    <script src="assets/js/jquery.dataTables.min.js"></script>
    <script src="assets/js/dataTables.bootstrap5.min.js"></script>

    <!-- Debug script to check if files are loaded -->
    <script>
      // Suppress console errors from browser extensions
      const originalError = console.error;
      console.error = function (...args) {
        const message = args.join(" ");
        if (
          message.includes("runtime.lastError") ||
          message.includes("message port closed") ||
          message.includes("asynchronous response")
        ) {
          return; // Suppress these specific errors
        }
        originalError.apply(console, args);
      };

      // Check if jQuery is loaded
      if (typeof $ === "undefined") {
        console.error("jQuery failed to load");
      } else {
        console.log("jQuery loaded successfully");
      }

      // Check if DataTables is loaded
      if (typeof $.fn.DataTable === "undefined") {
        console.error("DataTables failed to load");
      } else {
        console.log("DataTables loaded successfully");
      }

      // Handle font loading errors gracefully
      document.addEventListener("DOMContentLoaded", function () {
        // Add fallback font styles if Google Fonts fail to load
        const style = document.createElement("style");
        style.textContent = `
          body {
            font-family: 'Noto Naskh Arabic', Arial, Tahoma, 'Segoe UI', sans-serif !important;
          }
          .arabic-text {
            font-family: 'Noto Naskh Arabic', Arial, Tahoma, 'Segoe UI', sans-serif !important;
          }
        `;
        document.head.appendChild(style);

        // Log font loading status
        console.log("Font fallback styles applied");
      });
    </script>

    <!-- Common styles -->
    <link href="assets/css/styles.css" rel="stylesheet" />

    <style>
      /* Page-specific styles for dashboard.html */

      .menu-item i {
        margin-left: 8px;
        width: 20px;
        text-align: center;
      }

      .menu-item:hover {
        background-color: #f5f5f5;
      }

      body[dir="ltr"] .menu-dropdown-content {
        right: auto;
        left: 0;
      }

      body[dir="ltr"] .menu-item i {
        margin-left: 0;
        margin-right: 8px;
      }

      /* Font Awesome icon styles */
      .fa,
      .fab,
      .fas,
      .far,
      i.fa,
      i.fab,
      i.fas,
      i.far,
      i.fa-facebook-f,
      i.fa-x-twitter,
      i.fa-instagram,
      i.fa-linkedin-in,
      i.fa-whatsapp {
        font-family: "Font Awesome 6 Free", "Font Awesome 6 Brands" !important;
        display: inline-block !important;
        visibility: visible !important;
      }
    </style>

    <style>
      .dashboard {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
        padding: 1rem;
        width: 100%;
      }

      .card-box {
        min-width: 250px;
        transition: all 0.4s ease-in-out;
        overflow: hidden;
        cursor: pointer;
        position: relative;
        animation: fadeIn 0.5s ease-in;
        grid-column: auto;
        grid-row: auto;
      }

      .card-box.active {
        z-index: 10;
        grid-column: span 2;
        grid-row: span 2;
      }

      /* توسع خاص لكارد السجل ليأخذ مساحة 9 كروت */
      .card-box.log-card.active {
        grid-column: span 3 !important;
        grid-row: span 3 !important;
        min-width: 750px;
        min-height: 600px;
        transition: all 0.5s cubic-bezier(0.4, 0.2, 0.2, 1);
      }

      .card-body-extra {
        display: none;
        margin-top: 2rem;
        background-color: #e9ecef;
        padding: 1rem;
        border-radius: 0.5rem;
        animation: slideDown 0.4s ease forwards;
        color: black;
      }

      .card-box.active .card-body-extra {
        display: block;
      }

      .card-box.inactive {
        filter: brightness(95%) saturate(90%);
        opacity: 1;
        /* Add transform for animation */
        transform: translate(0, 0);
        transition: transform 0.4s ease-in-out, opacity 0.4s ease-in-out,
          filter 0.4s ease-in-out;
      }

      .card-box.inactive.moving {
        transition: transform 0.4s ease-in-out;
      }

      @media (max-width: 768px) {
        .dashboard {
          grid-template-columns: 1fr;
        }

        .card-box.active {
          grid-column: 1;
          grid-row: span 2;
        }
      }

      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }

        to {
          opacity: 1;
        }
      }

      .scrollable-table {
        max-height: 200px;
        overflow-y: auto;
      }

      .explore-btn {
        background-color: #fff;
        color: #000;
        border: 2px solid #000;
        border-radius: 8px;
        padding: 8px 20px;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .explore-btn:hover {
        background-color: #000;
        color: #fff;
      }

      /* Notifications Dropdown */
      .notifications-dropdown {
        position: relative;
        display: inline-block;
      }

      .notifications-toggle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.18);
        color: #fff;
        border: 2px solid rgba(255, 255, 255, 0.7);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        position: relative;
      }

      .notifications-toggle:hover {
        background: rgba(255, 255, 255, 0.32);
        transform: scale(1.05);
      }

      .notifications-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background-color: #ef4444;
        color: white;
        border-radius: 50%;
        width: 18px;
        height: 18px;
        font-size: 0.7rem;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        border: 2px solid #fff;
      }

      /* Modal Table Styles */
      .table-hover tbody tr:hover {
        background-color: #eaf6ff;
        transition: 0.3s ease;
      }

      .table-container {
        background-color: #ffffff;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        padding: 20px;
      }

      /* Improved DataTables Filter Styles */
      .dataTables_filter {
        margin-bottom: 15px;
      }

      .dataTables_filter label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
        color: #333;
        margin-bottom: 0;
        flex-wrap: wrap;
      }

      /* Hide the search label text */
      .dataTables_filter label:before {
        content: "";
        display: none;
      }

      .dataTables_filter input {
        border-radius: 25px;
        padding: 8px 16px;
        border: 2px solid #e0e0e0;
        background-color: #f8f9fa;
        transition: all 0.3s ease;
        min-width: 200px;
        font-size: 14px;
      }

      .dataTables_filter input:focus {
        outline: none;
        border-color: #007bff;
        background-color: #fff;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
      }

      .dataTables_filter input::placeholder {
        color: #6c757d;
        font-style: italic;
      }

      /* Responsive improvements for DataTables */
      @media (max-width: 768px) {
        .dataTables_filter {
          margin-bottom: 10px;
        }

        .dataTables_filter label {
          flex-direction: column;
          align-items: stretch;
          gap: 5px;
        }

        .dataTables_filter input {
          min-width: 100%;
          width: 100%;
          margin-top: 5px;
        }

        /* تحسين مظهر قائمة الاختيار في الشاشات الصغيرة */
        .dataTables_length select {
          min-width: 60px;
          font-size: 13px;
          padding: 6px 8px;
          padding-right: 25px;
        }

        [dir="rtl"] .dataTables_length select {
          padding-right: 8px;
          padding-left: 25px;
        }
      }

      @media (max-width: 576px) {
        .table-container {
          padding: 15px;
        }

        .dataTables_filter input {
          font-size: 16px; /* Prevents zoom on iOS */
          padding: 10px 16px;
        }
      }

      /* Reduce modal height and make body scrollable */
      #logModal .modal-dialog {
        max-width: 900px;
      }
      #logModal .modal-content {
        max-height: 70vh;
        min-height: 350px;
        display: flex;
        flex-direction: column;
      }
      #logModal .modal-body {
        overflow-y: auto;
        flex: 1 1 auto;
      }

      /* Align table headers to the right */
      #logTable th {
        text-align: right !important;
      }

      /* Enhanced table styling */
      #logTable {
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        border: 1px solid #dee2e6;
      }

      #logTable thead th {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        color: white;
        font-weight: 600;
        padding: 12px 8px;
        border: none;
        position: relative;
      }

      /* تحسين تصميم رؤوس الأعمدة في كروت الأحياء ودوائر الخدمات */
      .card-body-extra table thead th {
        background: linear-gradient(135deg, #00b2e3 0%, #0056b3 100%);
        color: white;
        font-weight: 600;
        padding: 15px 12px;
        border: none;
        position: relative;
        text-align: center;
        font-size: 14px;
        letter-spacing: 0.5px;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }

      .card-body-extra table thead th:hover {
        background: linear-gradient(135deg, #0056b3 0%, #004085 100%);
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .card-body-extra table thead th::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #28a745, #20c997, #17a2b8);
        border-radius: 0 0 3px 3px;
      }

      .card-body-extra table thead th i {
        margin-left: 8px;
        font-size: 16px;
        opacity: 0.9;
        transition: all 0.3s ease;
      }

      .card-body-extra table thead th:hover i {
        transform: scale(1.1);
        opacity: 1;
      }

      /* تحسين مظهر الجداول في الكروت */
      .card-body-extra table {
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        border: 1px solid #dee2e6;
        background: white;
      }

      .card-body-extra table tbody tr {
        transition: all 0.3s ease;
        border-bottom: 1px solid #f8f9fa;
      }

      .card-body-extra table tbody tr:hover {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        transform: translateX(2px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .card-body-extra table tbody td {
        padding: 12px 10px;
        vertical-align: middle;
        border: none;
        border-bottom: 1px solid #f8f9fa;
        font-weight: 500;
        color: #495057;
      }

      /* تناوب ألوان الصفوف */
      .card-body-extra table tbody tr:nth-child(even) {
        background-color: #f8f9fa;
      }

      .card-body-extra table tbody tr:nth-child(even):hover {
        background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      }

      /* تحسين مظهر الأيقونات في رؤوس الأعمدة */
      .card-body-extra table thead th i.fas {
        display: inline-block;
        width: 20px;
        text-align: center;
        margin-left: 6px;
        margin-right: 6px;
        color: rgba(255, 255, 255, 0.9);
        transition: all 0.3s ease;
      }

      .card-body-extra table thead th:hover i.fas {
        color: #ffffff;
        transform: scale(1.1) rotate(5deg);
      }

      /* تحسين مظهر الجداول في الوضع RTL */
      [dir="rtl"] .card-body-extra table thead th i {
        margin-left: 0;
        margin-right: 8px;
      }

      /* تحسين مظهر الجداول في الشاشات الصغيرة */
      @media (max-width: 768px) {
        .card-body-extra table thead th {
          padding: 10px 8px;
          font-size: 12px;
        }

        .card-body-extra table thead th i {
          font-size: 14px;
          margin-left: 4px;
          margin-right: 4px;
        }

        .card-body-extra table tbody td {
          padding: 8px 6px;
          font-size: 12px;
        }
      }

      #logTable thead th::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: linear-gradient(90deg, #28a745, #20c997);
      }

      #logTable tbody tr {
        transition: all 0.3s ease;
        border-bottom: 1px solid #f8f9fa;
      }

      #logTable tbody tr:hover {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        transform: translateX(2px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      #logTable tbody td {
        padding: 10px 8px;
        vertical-align: middle;
        border: none;
        border-bottom: 1px solid #f8f9fa;
      }

      /* Alternating row colors */
      #logTable tbody tr:nth-child(even) {
        background-color: #f8f9fa;
      }

      #logTable tbody tr:nth-child(even):hover {
        background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      }

      /* Enhanced table container */
      .table-container {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        border-radius: 16px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        padding: 20px;
        border: 1px solid #e9ecef;
        position: relative;
        overflow: hidden;
      }

      .table-container::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #007bff, #28a745, #ffc107, #dc3545);
      }

      /* Loading state for table */
      .table-container.loading {
        position: relative;
      }

      .table-container.loading::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 40px;
        height: 40px;
        margin: -20px 0 0 -20px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #007bff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        z-index: 1000;
      }

      /* Responsive table improvements */
      @media (max-width: 768px) {
        .table-container {
          padding: 15px;
          border-radius: 12px;
        }

        #logTable thead th {
          padding: 8px 6px;
          font-size: 12px;
        }

        #logTable tbody td {
          padding: 6px 4px;
          font-size: 11px;
        }
      }

      /* Enhanced DataTables Pagination Styles */
      .dataTables_paginate {
        margin-top: 15px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 5px;
      }

      .dataTables_paginate .paginate_button {
        border: 2px solid #e0e0e0;
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        color: #495057 !important;
        padding: 8px 12px;
        margin: 0 2px;
        border-radius: 8px;
        font-weight: 500;
        font-size: 14px;
        transition: all 0.3s ease;
        cursor: pointer;
        min-width: 40px;
        text-align: center;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .dataTables_paginate .paginate_button:hover {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        color: #ffffff !important;
        border-color: #007bff;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 123, 255, 0.3);
      }

      .dataTables_paginate .paginate_button.current {
        background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
        color: #ffffff !important;
        border-color: #28a745;
        box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
        transform: translateY(-1px);
      }

      .dataTables_paginate .paginate_button.disabled {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        color: #6c757d !important;
        border-color: #dee2e6;
        cursor: not-allowed;
        opacity: 0.6;
        transform: none;
        box-shadow: none;
      }

      .dataTables_paginate .paginate_button.disabled:hover {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        color: #6c757d !important;
        border-color: #dee2e6;
        transform: none;
        box-shadow: none;
      }

      .dataTables_paginate .paginate_button.previous,
      .dataTables_paginate .paginate_button.next {
        font-size: 12px;
        padding: 8px 10px;
        min-width: 35px;
      }

      .dataTables_paginate .paginate_button.previous i,
      .dataTables_paginate .paginate_button.next i {
        font-size: 10px;
      }

      /* RTL Support for pagination */
      [dir="rtl"] .dataTables_paginate .paginate_button.previous i {
        transform: rotate(180deg);
      }

      [dir="rtl"] .dataTables_paginate .paginate_button.next i {
        transform: rotate(180deg);
      }

      /* Responsive pagination */
      @media (max-width: 768px) {
        .dataTables_paginate {
          flex-wrap: wrap;
          gap: 3px;
        }

        .dataTables_paginate .paginate_button {
          padding: 6px 8px;
          font-size: 12px;
          min-width: 35px;
        }

        .dataTables_paginate .paginate_button.previous,
        .dataTables_paginate .paginate_button.next {
          padding: 6px 8px;
          min-width: 30px;
        }
      }

      @media (max-width: 576px) {
        .dataTables_paginate {
          justify-content: center;
          margin-top: 10px;
        }

        .dataTables_paginate .paginate_button {
          padding: 5px 6px;
          font-size: 11px;
          min-width: 30px;
        }
      }

      /* Enhanced pagination container */
      .enhanced-pagination {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: 12px;
        padding: 0px 5px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border: 1px solid #dee2e6;
      }

      /* Improved pagination button spacing */
      .enhanced-pagination .paginate_button {
        margin: 0 1px;
        position: relative;
        overflow: hidden;
      }

      .enhanced-pagination .paginate_button::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      .enhanced-pagination .paginate_button:hover::before {
        left: 100%;
      }

      /* Active page indicator */
      .enhanced-pagination .paginate_button.current::after {
        content: "";
        position: absolute;
        bottom: -2px;
        left: 50%;
        transform: translateX(-50%);
        width: 20px;
        height: 3px;
        background: linear-gradient(90deg, #28a745, #20c997);
        border-radius: 2px;
      }

      /* Disabled state improvements */
      .enhanced-pagination .paginate_button.disabled {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        color: #adb5bd !important;
        border-color: #ced4da;
        cursor: not-allowed;
        opacity: 0.5;
      }

      /* RTL specific improvements */
      [dir="rtl"] .enhanced-pagination .paginate_button {
        margin: 0 1px;
      }

      [dir="rtl"] .enhanced-pagination .paginate_button.current::after {
        left: 50%;
        transform: translateX(-50%);
      }

      /* Hover effect for pagination buttons */
      .enhanced-pagination .paginate_button.hover-effect {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 6px 12px rgba(0, 123, 255, 0.4);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      /* Loading animation for pagination */
      .enhanced-pagination.loading {
        opacity: 0.7;
        pointer-events: none;
      }

      .enhanced-pagination.loading::after {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        margin: -10px 0 0 -10px;
        border: 2px solid #f3f3f3;
        border-top: 2px solid #007bff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Improved focus states for accessibility */
      .enhanced-pagination .paginate_button:focus {
        outline: 2px solid #007bff;
        outline-offset: 2px;
        box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
      }

      /* Smooth transitions for all pagination elements */
      .enhanced-pagination * {
        transition: all 0.3s ease;
      }

      /* Click effect for pagination buttons */
      .enhanced-pagination .paginate_button.click-effect {
        transform: scale(0.95);
        box-shadow: 0 2px 4px rgba(0, 123, 255, 0.3);
        transition: all 0.2s ease;
      }

      /* Pulse animation for current page */
      .enhanced-pagination .paginate_button.current {
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
        }
        50% {
          box-shadow: 0 4px 8px rgba(40, 167, 69, 0.6);
        }
        100% {
          box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
        }
      }

      /* Improved disabled state with better visual feedback */
      .enhanced-pagination .paginate_button.disabled {
        position: relative;
      }

      .enhanced-pagination .paginate_button.disabled::after {
        content: "🚫";
        position: absolute;
        top: -8px;
        right: -8px;
        font-size: 10px;
        opacity: 0.7;
      }

      /* Improved length menu styling */
      .dataTables_length {
        margin-bottom: 15px;
      }

      .dataTables_length label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
        color: #333;
        margin-bottom: 0;
      }

      .dataTables_length select {
        border-radius: 6px;
        padding: 4px 8px;
        border: 2px solid #e0e0e0;
        background-color: #f8f9fa;
        transition: all 0.3s ease;
        font-size: 14px;
        /* إصلاح مشكلة السهم */
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 8px center;
        background-size: 16px;
        padding-right: 30px;
        min-width: 80px;
        cursor: pointer;
      }

      .dataTables_length select:focus {
        outline: none;
        border-color: #007bff;
        background-color: #fff;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
      }

      .dataTables_length select:hover {
        border-color: #007bff;
        background-color: #fff;
      }

      /* RTL support for select arrow */
      [dir="rtl"] .dataTables_length select {
        background-position: left 8px center;
        padding-right: 8px;
        padding-left: 30px;
      }

      /* Enhanced select styling for better visibility */
      .dataTables_length select option {
        padding: 8px 12px;
        background-color: #fff;
        color: #333;
      }

      .dataTables_length select option:hover {
        background-color: #007bff;
        color: #fff;
      }

      /* تحسين مظهر القائمة المنسدلة */
      .dataTables_length select:focus {
        border-color: #007bff;
        background-color: #fff;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
      }

      /* إصلاح مشكلة السهم في المتصفحات المختلفة */
      .dataTables_length select::-ms-expand {
        display: none;
      }

      /* تحسين مظهر القائمة في Firefox */
      .dataTables_length select:-moz-focusring {
        color: transparent;
        text-shadow: 0 0 0 #000;
      }

      /* تحسين مظهر القائمة في Webkit browsers */
      .dataTables_length select::-webkit-select-placeholder {
        color: #6c757d;
      }

      /* Card Icons and Colors */
      .card-icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        transition: all 0.3s ease;
      }

      /* All Cards - Same Blue Color */
      .population-card,
      .housing-card,
      .neighborhoods-card,
      .services-card,
      .urban-card,
      .log-card {
        background: linear-gradient(135deg, #00b2e3 0%, #0056b3 100%);
        color: white;
        border: none;
        box-shadow: 0 4px 15px rgba(0, 178, 227, 0.3);
        transition: all 0.3s ease;
      }

      /* Hover effects for all cards */
      .population-card:hover,
      .housing-card:hover,
      .neighborhoods-card:hover,
      .services-card:hover,
      .urban-card:hover,
      .log-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0, 178, 227, 0.4);
      }

      /* Card icons color */
      .population-card .card-icon,
      .housing-card .card-icon,
      .neighborhoods-card .card-icon,
      .services-card .card-icon,
      .urban-card .card-icon,
      .log-card .card-icon {
        color: #fff;
      }

      /* Hover effects for card icons */
      .population-card:hover .card-icon,
      .housing-card:hover .card-icon,
      .neighborhoods-card:hover .card-icon,
      .services-card:hover .card-icon,
      .urban-card:hover .card-icon,
      .log-card:hover .card-icon {
        transform: scale(1.1);
        color: #fff;
      }

      /* Log Card Special Styling for 9 Cards Space */
      .log-card {
        position: relative;
        z-index: 10;
      }

      /* Update Text Styling */
      .update-text {
        text-align: center;
        margin-top: 15px;
        padding: 10px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        color: rgba(255, 255, 255, 0.9);
        border: 1px solid rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(5px);
        transition: all 0.3s ease;
        animation: fadeInUp 0.5s ease-out;
      }

      .update-text:hover {
        background: rgba(255, 255, 255, 0.15);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .log-card.active {
        grid-column: span 3 !important;
        grid-row: span 3 !important;
        min-width: 750px;
        min-height: 600px;
        z-index: 1000;
      }

      /* Social Media Icons in Footer */
      .social-icons .social-icon {
        color: #fff;
        transition: all 0.3s ease;
      }

      .social-icons .social-icon:hover {
        color: #3498db;
        transform: scale(1.2);
      }

      /* Log Card Expand Animation */
      .expanding-log-card {
        z-index: 2000;
        position: fixed !important;
        left: 50%;
        top: 50%;
        width: 300px;
        height: 120px;
        transform: translate(-50%, -50%) scale(1);
        transition: all 0.5s cubic-bezier(0.4, 0.2, 0.2, 1);
        box-shadow: 0 0 40px 10px rgba(0, 0, 0, 0.2);
      }
      .expanding-log-card.expand {
        width: 900px;
        height: 70vh;
        min-height: 350px;
        max-width: 95vw;
        max-height: 90vh;
        background: #fff;
        color: #222;
        transition: all 0.5s cubic-bezier(0.4, 0.2, 0.2, 1);
      }
      .expanding-log-card .card-title,
      .expanding-log-card .card-text {
        color: inherit;
      }
      .expanding-log-card.hide {
        display: none !important;
      }

      /* عند ظهور المودال، أخفِ الكارد */
      .modal.show ~ .expanding-log-card {
        display: none !important;
      }
    </style>
  </head>

  <body class="g-sidenav-show bg-gray-100">
    <!-- Header -->
    <header id="mainHeader">
      <div style="display: flex; align-items: center; gap: 10px">
        <img
          src="assets/img/aleppo.jfif"
          alt="Logo 1"
          class="header-logo"
          onclick="window.location.href = './welcome.html';"
          style="cursor: pointer"
          title="Aleppo Governorate"
        />
      </div>

      <div class="header-title text-center">
        <div class="title-ar">نظام إدارة المعلومات الحضرية _ مدينة حلب</div>
        <div class="title-en">
          Urban Information Management System - Aleppo City
        </div>
      </div>

      <div class="header-logos right-logos">
        <div class="menu-dropdown">
          <button
            class="menu-toggle"
            id="menuToggleBtn"
            onclick="toggleMenu()"
          ></button>
          <div class="menu-dropdown-content" id="menuDropdown">
            <a
              href="#"
              class="menu-item"
              id="langToggleBtn"
              onclick="toggleLanguage();"
            >
              <i class="fas fa-language"></i>
              <span id="langToggleText">تغيير اللغة</span>
            </a>
            <a
              href="#"
              class="menu-item"
              id="settingsBtn"
              onclick="window.location.href = './profile.html';"
            >
              <i class="fas fa-cog"></i>
              <span id="settingsText">الإعدادات</span>
            </a>
            <a
              href="#"
              class="menu-item"
              id="logoutBtn"
              onclick="logoutUser();"
            >
              <i class="fas fa-sign-out-alt"></i>
              <span id="logoutText">تسجيل الخروج</span>
            </a>
          </div>
        </div>
        <img
          src="assets/img/unhabitat.png"
          alt="Logo 3"
          class="header-logo"
          title="UN Habitat"
          style="background-color: #fff"
        />
        <img
          src="assets/img/japan.jpg"
          alt="Logo 2"
          class="header-logo"
          title="From the People of Japanese "
        />
      </div>
    </header>

    <aside
      class="sidenav navbar navbar-vertical navbar-expand-xs border-0 fixed-end bg-gray-300"
      id="sidenav-main"
    >
      <div class="sidenav-header">
        <i
          class="fas fa-times p-3 cursor-pointer text-secondary opacity-5 position-absolute end-0 top-0 d-none d-xl-none"
          aria-hidden="true"
          id="iconSidenav"
        ></i>
      </div>

      <div class="collapse navbar-collapse">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link active" href="dashboard.html">
              <div
                class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 ms-2 d-flex align-items-center justify-content-center"
                style="
                  background: linear-gradient(
                    135deg,
                    #007bff 0%,
                    #0056b3 100%
                  ) !important;
                "
              >
                <i
                  class="fas fa-tachometer-alt"
                  style="color: white; font-size: 20px"
                ></i>
              </div>
              <span class="nav-link-text ms-1">Dashboard</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="tables.html">
              <div
                class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 ms-2 d-flex align-items-center justify-content-center"
              >
                <i
                  class="fas fa-table"
                  style="color: black; font-size: 20px"
                ></i>
              </div>
              <span class="nav-link-text ms-1">configuration Tables </span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="ManageUsers.html">
              <div
                class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 ms-2 d-flex align-items-center justify-content-center"
              >
                <i
                  class="fas fa-users-cog"
                  style="color: black; font-size: 20px"
                ></i>
              </div>
              <span class="nav-link-text ms-1">Manage users</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="neighborhoodCommitteesManagement.html">
              <div
                class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 ms-2 d-flex align-items-center justify-content-center"
              >
                <i
                  class="fas fa-users"
                  style="color: black; font-size: 20px"
                ></i>
              </div>
              <span class="nav-link-text ms-1">إدارة لجان الأحياء</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="developmentCommitteesManagement.html">
              <div
                class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 ms-2 d-flex align-items-center justify-content-center"
              >
                <i
                  class="fas fa-chart-line"
                  style="color: black; font-size: 20px"
                ></i>
              </div>
              <span class="nav-link-text ms-1">إدارة لجان التنمية</span>
            </a>
          </li>
        </ul>
      </div>
      <div class="sidenav-footer mx-3"></div>
    </aside>
    <main
      class="main-content position-relative max-height-vh-100 h-100 border-radius-lg mt-4"
    >
      <div class="container py-5">
        <!-- <h2 class="text-center mb-4">لوحة التحكم</h2> -->
        <div class="dashboard" id="dashboard">
          <!-- Population Box -->
          <div
            class="card card-box population-card"
            onclick="expandCard(this, 'sakanExtra')"
          >
            <div class="card-body text-center">
              <div class="card-icon">
                <i class="fas fa-user-friends"></i>
              </div>
              <h5 class="card-title" id="sakanTitle">السكان</h5>
              <p class="card-text" id="sakanCount">عدد السكان: 1,000,000</p>
              <div class="card-body-extra" id="sakanExtra">
                <p id="sakanFamilies">عدد الأسر: 185,185</p>
              </div>
            </div>
          </div>

          <!-- Housing Box -->
          <div
            class="card card-box housing-card"
            onclick="expandCard(this, 'maskanChartContainer')"
          >
            <div class="card-body text-center">
              <div class="card-icon">
                <i class="fas fa-home"></i>
              </div>
              <h5 class="card-title" id="maskanTitle">المساكن</h5>
              <p class="card-text" id="maskanCount">عدد المساكن: 90000</p>
              <p class="card-text" id="maskanArea">المساحة العمرانية: 19000 هكتار</p>
              <div class="card-body-extra" id="maskanChartContainer">
                <canvas id="maskanChart"></canvas>
              </div>
            </div>
          </div>

          <!-- Neighborhoods Box -->
          <div
            class="card card-box neighborhoods-card"
            onclick="expandCard(this, 'hayTable')"
          >
            <div class="card-body text-center">
              <div class="card-icon">
                <i class="fas fa-map"></i>
              </div>
              <h5 class="card-title" id="hayTitle">الأحياء</h5>
              <p class="card-text" id="hayCount">عدد الأحياء: 20</p>
              <div class="card-body-extra" id="hayTable">
                <div class="scrollable-table">
                  <table
                    class="table table-bordered table-striped bg-white text-black"
                  >
                    <thead>
                      <tr>
                        <th id="hayNameHeader">
                          <i class="fas fa-house me-1"></i>اسم الحي
                        </th>
                        <th id="hayResponsibleHeader">
                          <i class="fas fa-user me-1"></i>المسؤول
                        </th>
                        <th id="hayPhoneHeader">
                          <i class="fas fa-phone me-1"></i>الهاتف
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>حي الزهور</td>
                        <td>أحمد العلي</td>
                        <td>0912345678</td>
                      </tr>
                      <tr>
                        <td>حي الربيع</td>
                        <td>منى خالد</td>
                        <td>0945678912</td>
                      </tr>
                      <tr>
                        <td>حي النور</td>
                        <td>سامي محمد</td>
                        <td>0998765432</td>
                      </tr>
                      <tr>
                        <td>حي الشام</td>
                        <td>ليلى يوسف</td>
                        <td>0987654321</td>
                      </tr>
                      <tr>
                        <td>حي الثورة</td>
                        <td>علي حسن</td>
                        <td>0934567890</td>
                      </tr>
                      <tr>
                        <td>حي الجلاء</td>
                        <td>هند سالم</td>
                        <td>0954321876</td>
                      </tr>
                      <tr>
                        <td>حي الفتح</td>
                        <td>باسل محمود</td>
                        <td>0923456789</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <!-- Service Departments Box -->
          <div
            class="card card-box services-card"
            onclick="expandCard(this, 'serviceList')"
          >
            <div class="card-body text-center">
              <div class="card-icon">
                <i class="fas fa-tools"></i>
              </div>
              <h5 class="card-title" id="serviceTitle">دوائر الخدمات</h5>
              <p class="card-text" id="serviceCount">عدد الدوائر: 15</p>
              <div class="card-body-extra" id="serviceList">
                <div class="scrollable-table">
                  <table
                    class="table table-bordered table-striped bg-white text-black"
                  >
                    <thead>
                      <tr>
                        <th id="serviceNameHeader">
                          <i class="fas fa-building me-1"></i>اسم الدائرة
                        </th>
                        <th id="serviceManagerHeader">
                          <i class="fas fa-user me-1"></i>اسم المدير
                        </th>
                        <th id="servicePhoneHeader">
                          <i class="fas fa-phone me-1"></i>رقم الهاتف
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>دائرة الكهرباء</td>
                        <td>علي يوسف</td>
                        <td>021-1234567</td>
                      </tr>
                      <tr>
                        <td>دائرة المياه</td>
                        <td>سالم نادر</td>
                        <td>021-2345678</td>
                      </tr>
                      <tr>
                        <td>دائرة النظافة</td>
                        <td>منى سالم</td>
                        <td>021-3456789</td>
                      </tr>
                      <tr>
                        <td>دائرة الطرق</td>
                        <td>رامي خالد</td>
                        <td>021-4567890</td>
                      </tr>
                      <tr>
                        <td>دائرة الزراعة</td>
                        <td>أحمد منصور</td>
                        <td>021-5678901</td>
                      </tr>
                      <tr>
                        <td>دائرة التعليم</td>
                        <td>هدى خليل</td>
                        <td>021-6789012</td>
                      </tr>
                      <tr>
                        <td>دائرة الصحة</td>
                        <td>باسل فادي</td>
                        <td>021-7890123</td>
                      </tr>
                      <tr>
                        <td>دائرة الإسكان</td>
                        <td>رنا يوسف</td>
                        <td>021-8901234</td>
                      </tr>
                      <tr>
                        <td>دائرة الإطفاء</td>
                        <td>مروان عبد</td>
                        <td>021-9012345</td>
                      </tr>
                      <tr>
                        <td>دائرة المرور</td>
                        <td>حسام علي</td>
                        <td>021-0123456</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <!-- Urban Area Box -->
          <div
            class="card card-box urban-card"
            onclick="expandCard(this, 'masahaChartContainer')"
          >
            <div class="card-body text-center">
              <div class="card-icon">
                <i class="fas fa-building"></i>
              </div>
              <h5 class="card-title" id="masahaTitle">المساحة العمرانية</h5>
              <p class="card-text" id="masahaText">نسبة التنظيم</p>
              <div class="card-body-extra" id="masahaChartContainer">
                <canvas id="masahaChart"></canvas>
              </div>
            </div>
          </div>

          <!-- Log Box -->
          <div
            class="card card-box log-card"
            onclick="expandCard(this, 'logTableContainer')"
            style="cursor: pointer"
          >
            <div class="card-body text-center">
              <div class="card-icon">
                <i class="fas fa-list-alt"></i>
              </div>
              <h5 class="card-title" id="logTitle">السجل</h5>
              <p class="card-text" id="logText">عرض سجل المستخدمين</p>
              <div
                class="card-body-extra"
                id="logTableContainer"
                style="direction: rtl"
              >
                <div class="table-container">
                  <table
                    id="logTable"
                    class="table table-striped table-bordered table-hover"
                  >
                    <thead class="table-primary">
                      <tr>
                        <th>معرّف المستخدم</th>
                        <th>تاريخ ووقت الإجراء</th>
                        <th>تفاصيل الإجراء</th>
                        <th>اسم الجدول</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>101</td>
                        <td>2024-06-01 09:15:23</td>
                        <td>إضافة مستخدم جديد</td>
                        <td>users</td>
                      </tr>
                      <tr>
                        <td>102</td>
                        <td>2024-06-01 10:05:11</td>
                        <td>تعديل بيانات حي</td>
                        <td>neighborhoods</td>
                      </tr>
                      <tr>
                        <td>103</td>
                        <td>2024-06-01 11:22:45</td>
                        <td>حذف سجل خدمة</td>
                        <td>services</td>
                      </tr>
                      <tr>
                        <td>101</td>
                        <td>2024-06-02 08:40:10</td>
                        <td>تغيير كلمة مرور</td>
                        <td>users</td>
                      </tr>
                      <tr>
                        <td>104</td>
                        <td>2024-06-02 12:30:55</td>
                        <td>إضافة لجنة جديدة</td>
                        <td>committees</td>
                      </tr>
                      <tr>
                        <td>102</td>
                        <td>2024-06-02 13:15:00</td>
                        <td>تعديل بيانات مستخدم</td>
                        <td>users</td>
                      </tr>
                      <tr>
                        <td>105</td>
                        <td>2024-06-03 09:50:33</td>
                        <td>إضافة معيار جديد</td>
                        <td>standards</td>
                      </tr>
                      <tr>
                        <td>103</td>
                        <td>2024-06-03 10:20:18</td>
                        <td>تعديل بيانات خدمة</td>
                        <td>services</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <div class="fixed-plugin">
      <a
        id="helpButton"
        class="fixed-plugin-button text-dark position-fixed px-3 py-2"
        style="bottom: 40px; z-index: 6000"
      >
        <i class="fa fa-question-circle py-2"> </i>
      </a>
    </div>
    <!--   Core JS Files   -->
    <script src="libraries/js/popper-2.11.8.min.js"></script>
    <script src="libraries/js/bootstrap-5.3.2.min.js"></script>
    <script src="libraries/js/perfect-scrollbar-1.5.5.min.js"></script>
    <script src="libraries/js/smooth-scrollbar-8.8.1.min.js"></script>
    <script src="libraries/js/chartjs-plugin-datalabels-2.2.0.min.js"></script>

    <!-- Language Toggle Script -->
    <script>
      const translations = {
        ar: {
          dir: "rtl",
          dashboard: "لوحة التحكم",
          configTables: "جداول الإعدادات",
          manageUsers: "إدارة المستخدمين ",
          langToggleText: "تغيير اللغة",
          settingsText: "الإعدادات",
          logoutText: "تسجيل الخروج",
          pageTitle: "صفحة فارغة",
          neighborhoodCommittees: "إدارة لجان الأحياء",
          developmentCommittees: "إدارة لجان التنمية والتطوع",
          sakanTitle: "السكان",
          sakanCount: "عدد السكان: ",
          sakanFamilies: "عدد الأسر: ",
          maskanTitle: "المساكن",
          maskanCount: "عدد المساكن: ",
          maskanArea: "المساحة العمرانية: ",
          hectare: "هكتار",
          hayTitle: "الأحياء",
          hayCount: "عدد الأحياء: ",
          hayNameHeader: "اسم الحي",
          hayResponsibleHeader: "المسؤول",
          hayPhoneHeader: "الهاتف",
          serviceTitle: "دوائر الخدمات",
          serviceCount: "عدد الدوائر: ",
          serviceNameHeader: "اسم الدائرة",
          serviceManagerHeader: "اسم المدير",
          servicePhoneHeader: "رقم الهاتف",
          masahaTitle: "المساحة العمرانية",
          masahaText: "نسبة التنظيم",
          logTitle: "السجل",
          logText: "عرض سجل المستخدمين",
          updateText: "وفقا لاخر تحديث، بتاريخ 05/05/2025",
        },
        en: {
          dir: "ltr",
          dashboard: "Dashboard",
          configTables: "Configuration Tables",
          manageUsers: "Manage Users",
          langToggleText: "Change Language",
          settingsText: "Settings",
          logoutText: "Logout",
          pageTitle: "Empty Page",
          neighborhoodCommittees: "Neighborhood Comm",
          developmentCommittees: "Development Comm",
          sakanTitle: "Population",
          sakanCount: "Population Count: ",
          sakanFamilies: "Number of Families: ",
          maskanTitle: "Housing",
          maskanCount: "Housing Units: ",
          maskanArea: "Urban Area: ",
          hectare: "hectares",
          hayTitle: "Neighborhoods",
          hayCount: "Number of Neighborhoods: ",
          hayNameHeader: "Neighborhood Name",
          hayResponsibleHeader: "Responsible",
          hayPhoneHeader: "Phone",
          serviceTitle: "Service Departments",
          serviceCount: "Number of Departments: ",
          serviceNameHeader: "Department Name",
          serviceManagerHeader: "Manager Name",
          servicePhoneHeader: "Phone Number",
          masahaTitle: "Urban Area",
          masahaText: "Organization Ratio",
          logTitle: "Log",
          logText: "View User Log",
          updateText: "According to the latest update, dated 05/05/2025",
        },
      };

      let currentLang = "ar";

      function switchLanguage(lang) {
        try {
          localStorage.setItem("preferredLanguage", lang);
        } catch (error) {
          console.error("Error saving language preference:", error);
        }

        const aside = document.getElementById("sidenav-main");
        if (aside) {
          aside.classList.remove("fixed-end", "fixed-start");
          aside.classList.add(lang === "ar" ? "fixed-end" : "fixed-start");
        }

        const helpButton = document.getElementById("helpButton");
        if (helpButton) {
          helpButton.style.left = lang === "ar" ? "20px" : "auto";
          helpButton.style.right = lang === "ar" ? "auto" : "20px";
        }

        // Update main content direction
        const mainContent = document.querySelector(".main-content");
        if (mainContent) {
          mainContent.style.direction = translations[lang].dir;
        }

        currentLang = lang;
        const t = translations[lang];

        document.documentElement.lang = lang;
        document.documentElement.dir = t.dir;

        const navTexts = document.querySelectorAll(".nav-link .nav-link-text");
        if (navTexts[0]) navTexts[0].textContent = t.dashboard;
        if (navTexts[1]) navTexts[1].textContent = t.configTables;
        if (navTexts[2]) navTexts[2].textContent = t.manageUsers;
        if (navTexts[3]) navTexts[3].textContent = t.neighborhoodCommittees;
        if (navTexts[4]) navTexts[4].textContent = t.developmentCommittees;

        const langToggleText = document.getElementById("langToggleText");
        if (langToggleText) langToggleText.textContent = t.langToggleText;

        const settingsText = document.getElementById("settingsText");
        if (settingsText) settingsText.textContent = t.settingsText;

        const logoutText = document.getElementById("logoutText");
        if (logoutText) logoutText.textContent = t.logoutText;

        const pageTitle = document.getElementById("pageTitle");
        if (pageTitle) pageTitle.textContent = t.pageTitle;

        // Update dashboard card texts
        if (document.getElementById("sakanTitle"))
          document.getElementById("sakanTitle").textContent = t.sakanTitle;
        if (document.getElementById("sakanCount"))
          document.getElementById("sakanCount").textContent =
            t.sakanCount + "1,000,000"; // Assuming count is static for now
        if (document.getElementById("sakanFamilies"))
          document.getElementById("sakanFamilies").textContent =
            t.sakanFamilies + "185,185"; // Assuming count is static for now

        if (document.getElementById("maskanTitle"))
          document.getElementById("maskanTitle").textContent = t.maskanTitle;
        if (document.getElementById("maskanCount"))
          document.getElementById("maskanCount").textContent =
            t.maskanCount + "90,000"; // Assuming count is static for now
        if (document.getElementById("maskanArea"))
          document.getElementById("maskanArea").textContent =
            t.maskanArea + "19,000 " + t.hectare; // Assuming area is static for now

        if (document.getElementById("hayTitle"))
          document.getElementById("hayTitle").textContent = t.hayTitle;
        if (document.getElementById("hayCount"))
          document.getElementById("hayCount").textContent = t.hayCount + "111"; // Assuming count is static for now
        if (document.getElementById("hayNameHeader"))
          document.getElementById("hayNameHeader").textContent =
            t.hayNameHeader;
        if (document.getElementById("hayResponsibleHeader"))
          document.getElementById("hayResponsibleHeader").textContent =
            t.hayResponsibleHeader;
        if (document.getElementById("hayPhoneHeader"))
          document.getElementById("hayPhoneHeader").textContent =
            t.hayPhoneHeader;

        if (document.getElementById("serviceTitle"))
          document.getElementById("serviceTitle").textContent = t.serviceTitle;
        if (document.getElementById("serviceCount"))
          document.getElementById("serviceCount").textContent =
            t.serviceCount + "15"; // Assuming count is static for now
        if (document.getElementById("serviceNameHeader"))
          document.getElementById("serviceNameHeader").textContent =
            t.serviceNameHeader;
        if (document.getElementById("serviceManagerHeader"))
          document.getElementById("serviceManagerHeader").textContent =
            t.serviceManagerHeader;
        if (document.getElementById("servicePhoneHeader"))
          document.getElementById("servicePhoneHeader").textContent =
            t.servicePhoneHeader;

        if (document.getElementById("masahaTitle"))
          document.getElementById("masahaTitle").textContent = t.masahaTitle;
        if (document.getElementById("masahaText"))
          document.getElementById("masahaText").textContent = t.masahaText;

        if (document.getElementById("logTitle"))
          document.getElementById("logTitle").textContent = t.logTitle;
        if (document.getElementById("logText"))
          document.getElementById("logText").textContent = t.logText;

        // تحديث نص التحديث في الكروت النشطة
        const activeCards = document.querySelectorAll(".card-box.active");
        activeCards.forEach((card) => {
          const updateText = card.querySelector(".update-text");
          if (updateText) {
            updateText.textContent = t.updateText;
          }
        });
      }

      function toggleLanguage() {
        if (currentLang === "ar") {
          switchLanguage("en");
        } else {
          switchLanguage("ar");
        }
      }

      function toggleMenu() {
        const menu = document.getElementById("menuDropdown");
        menu.style.display = menu.style.display === "block" ? "none" : "block";
      }

      // Close menu when clicking outside
      document.addEventListener("click", function (e) {
        const menu = document.getElementById("menuDropdown");
        const menuBtn = document.getElementById("menuToggleBtn");
        if (
          menu &&
          menuBtn &&
          !menuBtn.contains(e.target) &&
          !menu.contains(e.target)
        ) {
          menu.style.display = "none";
        }
      });

      // Initialize page
      document.addEventListener("DOMContentLoaded", function () {
        const helpButton = document.getElementById("helpButton");
        if (helpButton) {
          helpButton.style.left = "20px";
          helpButton.style.right = "auto";
        }

        let savedLanguage;
        try {
          savedLanguage = localStorage.getItem("preferredLanguage");
        } catch (error) {
          console.error("Error retrieving language preference:", error);
          savedLanguage = null;
        }

        const initialLang = savedLanguage || "ar";
        switchLanguage(initialLang);

        // Initialize language toggle functionality
        // The language toggle is now handled through the menu dropdown

        // Handle zoom level changes
        function handleZoom() {
          const sidenav = document.getElementById("sidenav-main");
          const windowWidth = window.innerWidth;
          const zoomLevel = window.devicePixelRatio;

          if (sidenav) {
            sidenav.style.display =
              zoomLevel > 1.51 || windowWidth < 1200 ? "none" : "block";
          }
        }

        handleZoom();
        window.addEventListener("resize", handleZoom);
      });
    </script>

    <!-- Common User Functions -->
    <script src="assets/js/common-user-functions.js"></script>

    <script>
      function expandCard(card, id) {
        const cards = document.querySelectorAll(".card-box");
        cards.forEach((c) => {
          if (c !== card) {
            c.classList.remove("active");
            c.classList.add("inactive");
            // إزالة نص التحديث من الكروت غير النشطة
            const updateText = c.querySelector(".update-text");
            if (updateText) {
              updateText.remove();
            }
          } else {
            c.classList.add("active");
            c.classList.remove("inactive");
            // إضافة نص التحديث للكارد النشط
            addUpdateText(c);
          }
        });

        if (id === "maskanChartContainer")
          initChart(
            "maskanChart",
            ["متضرر", "سليمة", "إصلاح", "إزالة"],
            [30, 40, 14, 16],
            ["#dc3545", "#198754", "#ffc107", "#6c757d"]
          );
        if (id === "masahaChartContainer")
          initChart(
            "masahaChart",
            ["عشوائيات", "منظم"],
            [39, 61],
            ["#6610f2", "#0d6efd"]
          );
        // تهيئة DataTables عند توسع كارد السجل
        if (id === "logTableContainer") {
          setTimeout(function () {
            try {
              // Check if jQuery and DataTables are loaded
              if (typeof $ === "undefined") {
                console.error("jQuery is not loaded");
                showFallbackTable();
                return;
              }

              if (typeof $.fn.DataTable === "undefined") {
                console.error("DataTables is not loaded");
                showFallbackTable();
                return;
              }

              if (!$.fn.DataTable.isDataTable("#logTable")) {
                $("#logTable").DataTable({
                  pageLength: 5,
                  lengthMenu: [5, 10, 20, 50],
                  responsive: true,
                  dom:
                    '<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>' +
                    '<"row"<"col-sm-12"tr>>' +
                    '<"row"<"col-sm-12"p>>',
                  language: {
                    search: "",
                    lengthMenu: "عرض _MENU_ صف",
                    paginate: {
                      previous: '<i class="fas fa-chevron-right"></i>',
                      next: '<i class="fas fa-chevron-left"></i>',
                      first: '<i class="fas fa-angle-double-right"></i>',
                      last: '<i class="fas fa-angle-double-left"></i>',
                    },
                    zeroRecords: "لم يتم العثور على نتائج",
                  },
                  pagingType: "full_numbers",
                  drawCallback: function (settings) {
                    // تحسين مظهر الترقيم الصفحي بعد كل رسم
                    setTimeout(function () {
                      const paginateContainer = $(".dataTables_paginate");
                      if (paginateContainer.length) {
                        paginateContainer.addClass("enhanced-pagination");
                      }
                    }, 50);
                  },
                  initComplete: function () {
                    // Add placeholder to search input
                    $(".dataTables_filter input").attr(
                      "placeholder",
                      "اكتب للبحث في السجل..."
                    );

                    // تحسين مظهر الترقيم الصفحي بعد التهيئة
                    setTimeout(function () {
                      const paginateContainer = $(".dataTables_paginate");
                      if (paginateContainer.length) {
                        paginateContainer.addClass("enhanced-pagination");

                        // إضافة تأثيرات إضافية للأزرار
                        paginateContainer
                          .find(".paginate_button")
                          .each(function () {
                            $(this)
                              .on("mouseenter", function () {
                                if (
                                  !$(this).hasClass("disabled") &&
                                  !$(this).hasClass("current")
                                ) {
                                  $(this).addClass("hover-effect");
                                }
                              })
                              .on("mouseleave", function () {
                                $(this).removeClass("hover-effect");
                              })
                              .on("click", function () {
                                // إضافة تأثير النقر
                                if (!$(this).hasClass("disabled")) {
                                  $(this).addClass("click-effect");
                                  setTimeout(() => {
                                    $(this).removeClass("click-effect");
                                  }, 200);
                                }
                              });
                          });

                        // إضافة تأثير التحميل عند تغيير الصفحة
                        paginateContainer.on(
                          "click",
                          ".paginate_button:not(.disabled)",
                          function () {
                            paginateContainer.addClass("loading");
                            const tableContainer = $(".table-container");
                            tableContainer.addClass("loading");

                            setTimeout(() => {
                              paginateContainer.removeClass("loading");
                              tableContainer.removeClass("loading");
                            }, 300);
                          }
                        );

                        // إضافة تأثير التحميل عند البحث
                        $(".dataTables_filter input").on("input", function () {
                          const tableContainer = $(".table-container");
                          tableContainer.addClass("loading");

                          setTimeout(() => {
                            tableContainer.removeClass("loading");
                          }, 200);
                        });

                        // إضافة تأثير التحميل عند تغيير عدد الصفوف
                        $(".dataTables_length select").on(
                          "change",
                          function () {
                            const tableContainer = $(".table-container");
                            tableContainer.addClass("loading");

                            setTimeout(() => {
                              tableContainer.removeClass("loading");
                            }, 300);
                          }
                        );
                      }
                    }, 100);
                  },
                });
              }
            } catch (error) {
              console.error("Error initializing DataTable:", error);
              showFallbackTable();
            }
          }, 100);
        }

        // Fallback function to show a simple table if DataTables fails
        function showFallbackTable() {
          const tableContainer = document.getElementById("logTableContainer");
          if (tableContainer) {
            tableContainer.innerHTML = `
              <div class="alert alert-info">
                <h5>سجل المستخدمين</h5>
                <p>عرض البيانات في جدول بسيط (DataTables غير متاح)</p>
              </div>
              <div class="table-responsive">
                <table class="table table-striped table-bordered">
                  <thead class="table-primary">
                    <tr>
                      <th>معرّف المستخدم</th>
                      <th>تاريخ ووقت الإجراء</th>
                      <th>تفاصيل الإجراء</th>
                      <th>اسم الجدول</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>101</td>
                      <td>2024-06-01 09:15:23</td>
                      <td>إضافة مستخدم جديد</td>
                      <td>users</td>
                    </tr>
                    <tr>
                      <td>102</td>
                      <td>2024-06-01 10:05:11</td>
                      <td>تعديل بيانات حي</td>
                      <td>neighborhoods</td>
                    </tr>
                    <tr>
                      <td>103</td>
                      <td>2024-06-01 11:22:45</td>
                      <td>حذف سجل خدمة</td>
                      <td>services</td>
                    </tr>
                    <tr>
                      <td>101</td>
                      <td>2024-06-02 08:40:10</td>
                      <td>تغيير كلمة مرور</td>
                      <td>users</td>
                    </tr>
                    <tr>
                      <td>104</td>
                      <td>2024-06-02 12:30:55</td>
                      <td>إضافة لجنة جديدة</td>
                      <td>committees</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            `;
          }
        }
      }

      // دالة لإضافة نص التحديث للكارد
      function addUpdateText(card) {
        // إزالة نص التحديث السابق إن وجد
        const existingUpdateText = card.querySelector(".update-text");
        if (existingUpdateText) {
          existingUpdateText.remove();
        }

        // إنشاء عنصر النص الجديد
        const updateText = document.createElement("div");
        updateText.className = "update-text";

        // تحديد النص حسب اللغة الحالية
        const currentLang = document.documentElement.lang || "ar";
        if (currentLang === "ar") {
          updateText.textContent = "وفقا لاخر تحديث، بتاريخ 05/05/2025";
        } else {
          updateText.textContent =
            "According to the latest update, dated 05/05/2025";
        }

        // إضافة النص إلى الكارد
        const cardBody = card.querySelector(".card-body");
        if (cardBody) {
          cardBody.appendChild(updateText);
        }
      }

      function initChart(id, labels, data, colors) {
        const ctx = document.getElementById(id);
        if (!ctx.dataset.chart) {
          const chart = new Chart(ctx, {
            type: "pie",
            data: {
              labels: labels,
              datasets: [
                {
                  data: data,
                  backgroundColor: colors,
                },
              ],
            },
            options: {
              responsive: true,
              plugins: {
                legend: { position: "bottom" },
                datalabels: {
                  formatter: (value, context) => {
                    const total = context.chart.data.datasets[0].data.reduce(
                      (sum, current) => sum + current,
                      0
                    );
                    const percentage = ((value / total) * 100).toFixed(1) + "%";
                    return percentage;
                  },
                  color: "#fff",
                  font: {
                    weight: "bold",
                    size: 14,
                  },
                },
              },
            },
            plugins: [ChartDataLabels],
          });
          ctx.dataset.chart = true;
        }
      }
    </script>

    <script src="libraries/js/bootstrap-5.3.0-bundle.min.js"></script>

    <!-- Function to update notifications badge -->
    <script>
      // Update badge on page load
      document.addEventListener("DOMContentLoaded", function () {
        // Wait for common-user-functions.js to load

        // Check if DataTables files are loaded correctly
        setTimeout(() => {
          if (typeof $ === "undefined") {
            console.error("jQuery failed to load");
          } else {
            console.log("jQuery loaded successfully");
          }

          if (typeof $.fn.DataTable === "undefined") {
            console.error("DataTables failed to load");
          } else {
            console.log("DataTables loaded successfully");
          }
        }, 500);

        // Handle any remaining browser extension errors
        window.addEventListener("error", function (e) {
          if (
            e.message.includes("runtime.lastError") ||
            e.message.includes("message port closed") ||
            e.message.includes("asynchronous response")
          ) {
            e.preventDefault();
            return false;
          }
        });
      });
    </script>
  </body>
</html>
