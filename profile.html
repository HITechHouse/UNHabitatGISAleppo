<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link
      rel="shortcut icon"
      href="assets/img/UN_Habitat_Icon.svg"
      type="image/x-icon"
    />
    <title>Profile</title>
    <!-- Google Fonts -->
    <link href="libraries/css/inter.css" rel="stylesheet" />

    <!-- Simplified Arabic Font -->
    <link href="libraries/css/noto-naskh-arabic.css" rel="stylesheet" />
    <!-- Font Awesome Icons -->
    <link href="libraries/css/fontawesome-6.5.1.min.css" rel="stylesheet" />
    <!-- Bootstrap CSS -->
    <link
      href="libraries/css/bootstrap-5.3.0-alpha1.min.css"
      rel="stylesheet"
    />
    <!-- Soft UI Dashboard CSS -->
    <link
      id="pagestyle"
      href="assets/css/soft-ui-dashboard.css?v=1.1.0"
      rel="stylesheet"
    />

    <!-- Core JS Files for Soft UI Dashboard -->
    <script src="libraries/js/popper-2.11.6.min.js"></script>
    <script src="libraries/js/bootstrap-5.3.0-alpha1.min.js"></script>
    <script src="libraries/js/perfect-scrollbar-1.5.5.min.js"></script>
    <script src="libraries/js/smooth-scrollbar-8.8.1.min.js"></script>
    <!-- Github buttons -->
    <script src="libraries/js/buttons.js" async defer></script>
    <!-- Control Center for Soft UI Dashboard: parallax effects, scripts for the example pages etc -->
    <script src="libraries/js/soft-ui-dashboard-1.1.0.min.js"></script>

    <!-- Common styles -->
    <link href="assets/css/styles.css" rel="stylesheet" />

    <style>
      /* Page-specific styles for profile.html */

      .menu-item {
        display: flex;
        align-items: center;
        padding: 12px 16px;
        text-decoration: none;
        color: #333;
        transition: background-color 0.3s ease;
      }

      .menu-item i {
        margin-left: 8px;
        width: 20px;
        text-align: center;
      }

      .menu-item:hover {
        background-color: #f5f5f5;
      }

      body[dir="ltr"] .menu-dropdown-content {
        right: auto;
        left: 0;
      }

      body[dir="ltr"] .menu-item i {
        margin-left: 0;
        margin-right: 8px;
      }

      /* Card and chart styles */
      .card {
        border-radius: 1.5rem;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        background: linear-gradient(135deg, #ffffff, #f8f9fa);
        height: 100%;
        display: flex;
        flex-direction: column;
        border: 1px solid rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
      }

      .card:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
      }

      .card-body {
        flex: 1;
        display: flex;
        flex-direction: column;
        min-height: 200px;
        padding: 2rem;
      }

      .card-title {
        margin-bottom: 1.5rem;
        font-weight: 700;
        color: #2c3e50;
      }

      .card-text {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        margin: 0;
      }

      /* Main content area improvements */
      .main-content {
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        min-height: 100vh;
        padding: 2rem 0;
      }

      /* Container improvements */
      .container-fluid {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1.5rem;
      }

      /* Row spacing improvements */
      .row {
        margin-bottom: 2rem;
      }

      .row:last-child {
        margin-bottom: 0;
      }

      /* Account settings title improvements */
      .account-settings-title {
        font-size: 2.5rem;
        font-weight: 800;
        color: #1a237e;
        margin-bottom: 2rem;
        text-align: center;
        background: linear-gradient(135deg, #1a237e, #3949ab);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        position: relative;
        padding-bottom: 1rem;
      }

      .account-settings-title::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 80px;
        height: 4px;
        background: linear-gradient(135deg, #1a237e, #3949ab);
        border-radius: 2px;
      }

      /* Form improvements */
      .form-label {
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 0.75rem;
        font-size: 1.1rem;
      }

      .form-control {
        border-radius: 12px;
        border: 2px solid #e9ecef;
        padding: 0.875rem 1rem;
        font-size: 1rem;
        transition: all 0.3s ease;
        background-color: #ffffff;
        color: #495057;
        line-height: 1.5;
        min-height: 3.5rem;
        padding-right: 2.5rem !important;
        padding-left: 2.5rem !important;
        box-sizing: border-box;
      }

      body[dir="rtl"] .form-control {
        padding-right: 1.5rem !important;
        padding-left: 2.5rem !important;
      }

      body[dir="ltr"] .form-control {
        padding-left: 1.5rem !important;
        padding-right: 2.5rem !important;
      }

      .form-control:focus {
        border-color: #1a237e;
        box-shadow: 0 0 0 0.2rem rgba(26, 35, 126, 0.25);
        background-color: #ffffff;
        color: #495057;
      }

      .form-control:read-only {
        background-color: #f8f9fa;
        color: #6c757d;
        cursor: not-allowed;
      }

      /* Ensure text is always visible in form controls */
      .form-control::placeholder {
        color: #6c757d;
        opacity: 1;
      }

      .form-control::-webkit-input-placeholder {
        color: #6c757d;
        opacity: 1;
      }

      .form-control::-moz-placeholder {
        color: #6c757d;
        opacity: 1;
      }

      .form-control:-ms-input-placeholder {
        color: #6c757d;
        opacity: 1;
      }

      /* Button improvements */
      .btn {
        border-radius: 12px;
        padding: 0.875rem 2rem;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
        border: none;
        position: relative;
        overflow: hidden;
      }

      .btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }

      .btn:hover::before {
        left: 100%;
      }

      .btn-success {
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
      }

      .btn-success:hover {
        background: linear-gradient(135deg, #218838, #1ea085);
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(40, 167, 69, 0.3);
      }

      .btn-warning {
        background: linear-gradient(135deg, #5b67d6, #2121df);
        color: white;
      }

      .btn-warning:hover {
        background: linear-gradient(135deg, #192f77, #1a0999);
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(255, 193, 7, 0.3);
      }

      /* Password section improvements */
      .password-section {
        margin-top: 3rem;
        padding-top: 3rem;
        border-top: 3px solid #e9ecef;
        position: relative;
      }

      .password-section::before {
        content: "";
        position: absolute;
        top: -1.5px;
        left: 0;
        width: 100%;
        height: 3px;
        background: linear-gradient(135deg, #1a237e, #3949ab);
        border-radius: 1.5px;
      }

      /* Small text improvements */
      .text-muted {
        color: #6c757d !important;
        font-size: 0.9rem;
        font-style: italic;
      }

      /* Validation improvements */
      .is-invalid {
        border-color: #dc3545 !important;
        box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25) !important;
        background-color: #ffffff !important;
        color: #495057 !important;
      }

      .is-valid {
        border-color: #28a745 !important;
        box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25) !important;
        background-color: #ffffff !important;
        color: #495057 !important;
      }

      .invalid-feedback {
        display: block;
        color: #dc3545;
        font-size: 0.875rem;
        margin-top: 0.5rem;
        font-weight: 500;
      }

      .valid-feedback {
        display: block;
        color: #28a745;
        font-size: 0.875rem;
        margin-top: 0.5rem;
        font-weight: 500;
      }

      .chart-container {
        height: 100%;
        min-height: 200px;
      }

      canvas {
        width: 100% !important;
        height: 100% !important;
      }

      /* Font Awesome icon styles */
      .fa,
      .fab,
      .fas,
      .far,
      i.fa,
      i.fab,
      i.fas,
      i.far,
      i.fa-facebook-f,
      i.fa-x-twitter,
      i.fa-instagram,
      i.fa-linkedin-in,
      i.fa-whatsapp {
        font-family: "Font Awesome 6 Free", "Font Awesome 6 Brands" !important;
        display: inline-block !important;
        visibility: visible !important;
      }

      /* Enhanced Notification System */
      #notificationContainer {
        position: fixed;
        top: 20px;
        z-index: 9999;
        pointer-events: none;
        width: 100%;
        max-width: 400px;
      }

      /* RTL/LTR positioning */
      body[dir="rtl"] #notificationContainer {
        right: 20px;
      }

      body[dir="ltr"] #notificationContainer {
        left: 20px;
      }

      .notification {
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        margin-bottom: 10px;
        padding: 16px 20px;
        pointer-events: auto;
        position: relative;
        width: 100%;
        display: flex;
        align-items: flex-start;
        gap: 12px;
        opacity: 0;
        transform: translateX(-100%);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      /* RTL animation */
      body[dir="rtl"] .notification {
        transform: translateX(100%);
      }

      .notification.show {
        opacity: 1;
        transform: translateX(0);
      }

      .notification.hide {
        opacity: 0;
        transform: translateX(-100%);
      }

      body[dir="rtl"] .notification.hide {
        transform: translateX(100%);
      }

      .notification-icon {
        flex-shrink: 0;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: bold;
        color: #fff;
      }

      .notification-content {
        flex: 1;
        min-width: 0;
      }

      .notification-title {
        font-weight: 600;
        font-size: 14px;
        margin: 0 0 4px 0;
        line-height: 1.2;
      }

      .notification-message {
        font-size: 13px;
        margin: 0;
        line-height: 1.3;
        opacity: 0.8;
      }

      .notification-close {
        flex-shrink: 0;
        background: none;
        border: none;
        cursor: pointer;
        padding: 4px;
        border-radius: 4px;
        color: inherit;
        opacity: 0.6;
        transition: opacity 0.2s;
        font-size: 16px;
        line-height: 1;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .notification-close:hover {
        opacity: 1;
        background-color: rgba(0, 0, 0, 0.05);
      }

      /* Notification types */
      .notification.success {
        border-left: 4px solid #10b981;
      }

      body[dir="rtl"] .notification.success {
        border-left: none;
        border-right: 4px solid #10b981;
      }

      .notification.success .notification-icon {
        background-color: #10b981;
      }

      .notification.success .notification-title {
        color: #065f46;
      }

      .notification.success .notification-message {
        color: #047857;
      }

      .notification.error {
        border-left: 4px solid #ef4444;
      }

      body[dir="rtl"] .notification.error {
        border-left: none;
        border-right: 4px solid #ef4444;
      }

      .notification.error .notification-icon {
        background-color: #ef4444;
      }

      .notification.error .notification-title {
        color: #991b1b;
      }

      .notification.error .notification-message {
        color: #dc2626;
      }

      .notification.warning {
        border-left: 4px solid #f59e0b;
      }

      body[dir="rtl"] .notification.warning {
        border-left: none;
        border-right: 4px solid #f59e0b;
      }

      .notification.warning .notification-icon {
        background-color: #f59e0b;
      }

      .notification.warning .notification-title {
        color: #92400e;
      }

      .notification.warning .notification-message {
        color: #d97706;
      }

      .notification.info {
        border-left: 4px solid #3b82f6;
      }

      body[dir="rtl"] .notification.info {
        border-left: none;
        border-right: 4px solid #3b82f6;
      }

      .notification.info .notification-icon {
        background-color: #3b82f6;
      }

      .notification.info .notification-title {
        color: #1e40af;
      }

      .notification.info .notification-message {
        color: #2563eb;
      }

      /* Loading spinner */
      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid #f3f3f3;
        border-top: 3px solid #3498db;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Password section styles */
      .password-section {
        margin-top: 30px;
        padding-top: 30px;
        border-top: 2px solid #e9ecef;
      }

      /* Form validation */
      .is-invalid {
        border-color: #dc3545;
      }

      .is-valid {
        border-color: #28a745;
      }

      .invalid-feedback {
        display: block;
        color: #dc3545;
        font-size: 0.875rem;
        margin-top: 0.25rem;
      }

      .valid-feedback {
        display: block;
        color: #28a745;
        font-size: 0.875rem;
        margin-top: 0.25rem;
      }

      /* Additional improvements for better visual hierarchy */
      .card h6 {
        font-size: 1.5rem;
        font-weight: 700;
        color: #2c3e50;
        margin-bottom: 1.5rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid #e9ecef;
      }

      /* Responsive improvements */
      @media (max-width: 768px) {
        .account-settings-title {
          font-size: 2rem;
        }

        .container-fluid {
          padding: 0 1rem;
        }

        .card-body {
          padding: 1.5rem;
        }

        .btn {
          padding: 0.75rem 1.5rem;
          font-size: 0.9rem;
        }
      }

      /* Animation for form elements */
      .form-control,
      .btn {
        animation: fadeInUp 0.6s ease-out;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Enhanced focus states */
      .form-control:focus {
        transform: scale(1.02);
      }

      /* Loading state improvements */
      .btn:disabled {
        opacity: 0.7;
        cursor: not-allowed;
        transform: none !important;
      }

      /* Card hover effects */
      .card {
        cursor: default;
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
      }

      /* Enhanced spacing and layout */
      .py-7 {
        padding-top: 4rem !important;
        padding-bottom: 4rem !important;
      }

      /* Improved form spacing */
      .row.mt-3 {
        margin-top: 1.5rem !important;
      }

      /* Enhanced button spacing */
      .mt-3 .btn {
        margin-top: 1rem;
        min-width: 150px;
      }

      /* Better visual separation */
      .password-section {
        background: linear-gradient(135deg, #f8f9fa, #ffffff);
        border-radius: 1rem;
        padding: 2rem;
        margin-top: 3rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
      }

      /* Enhanced input groups */
      .col-md-6 {
        margin-bottom: 1rem;
      }

      /* Username field specific styling */
      #username {
        background-color: #ffffff;
        border: 2px solid #e9ecef;
        transition: all 0.3s ease;
      }

      #username:focus {
        border-color: #1a237e;
        box-shadow: 0 0 0 0.2rem rgba(26, 35, 126, 0.25);
      }

      /* Email field styling (readonly) */
      #email {
        background-color: #f8f9fa;
        color: #6c757d;
        cursor: not-allowed;
        border: 2px solid #e9ecef;
      }

      /* Enhanced form validation styling */
      .form-control.is-valid {
        border-color: #28a745 !important;
        box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25) !important;
        background-color: #ffffff !important;
        color: #495057 !important;
      }

      .form-control.is-invalid {
        border-color: #dc3545 !important;
        box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25) !important;
        background-color: #ffffff !important;
        color: #495057 !important;
      }

      /* Success and error feedback styling */
      .valid-feedback {
        color: #28a745;
        font-size: 0.875rem;
        margin-top: 0.5rem;
        font-weight: 500;
        display: block;
      }

      .invalid-feedback {
        color: #dc3545;
        font-size: 0.875rem;
        margin-top: 0.5rem;
        font-weight: 500;
        display: block;
      }

      /* Additional styles to ensure text visibility */
      .form-control.is-valid,
      .form-control.is-invalid {
        position: relative;
        z-index: 1;
        color: #495057 !important;
        background-color: #ffffff !important;
      }

      /* Force text visibility in all validation states */
      .form-control.is-valid,
      .form-control.is-invalid,
      .form-control.is-valid:focus,
      .form-control.is-invalid:focus {
        color: #495057 !important;
        background-color: #ffffff !important;
        -webkit-text-fill-color: #495057 !important;
      }

      /* Ensure text input values are always visible */
      .form-control[type="text"],
      .form-control[type="email"],
      .form-control[type="password"] {
        color: #495057 !important;
        background-color: #ffffff !important;
        opacity: 1 !important;
        visibility: visible !important;
      }

      /* Ensure text is visible in all states */
      .form-control:not(:placeholder-shown) {
        color: #495057 !important;
      }

      /* Fix for autofill styles */
      .form-control:-webkit-autofill,
      .form-control:-webkit-autofill:hover,
      .form-control:-webkit-autofill:focus {
        -webkit-text-fill-color: #495057 !important;
        -webkit-box-shadow: 0 0 0px 1000px #ffffff inset !important;
        transition: background-color 5000s ease-in-out 0s;
      }

      /* Additional fixes for validation states with autofill */
      .form-control.is-valid:-webkit-autofill,
      .form-control.is-invalid:-webkit-autofill {
        -webkit-text-fill-color: #495057 !important;
        -webkit-box-shadow: 0 0 0px 1000px #ffffff inset !important;
      }

      /* Ensure text is visible in all input types */
      input[type="text"],
      input[type="email"],
      input[type="password"] {
        color: #495057 !important;
        background-color: #ffffff !important;
      }

      /* Override any Bootstrap or other framework styles */
      .form-control,
      .form-control:focus,
      .form-control:active {
        color: #495057 !important;
        background-color: #ffffff !important;
      }

      /* Additional specificity to override any conflicting styles */
      .form-control[type="text"],
      .form-control[type="email"],
      .form-control[type="password"],
      .form-control[type="text"]:focus,
      .form-control[type="email"]:focus,
      .form-control[type="password"]:focus,
      .form-control[type="text"]:active,
      .form-control[type="email"]:active,
      .form-control[type="password"]:active {
        color: #495057 !important;
        background-color: #ffffff !important;
        -webkit-text-fill-color: #495057 !important;
      }

      /* Ensure text is visible even with validation classes */
      .form-control.is-valid[type="text"],
      .form-control.is-valid[type="email"],
      .form-control.is-valid[type="password"],
      .form-control.is-invalid[type="text"],
      .form-control.is-invalid[type="email"],
      .form-control.is-invalid[type="password"] {
        color: #495057 !important;
        background-color: #ffffff !important;
        -webkit-text-fill-color: #495057 !important;
      }

      /* Override any conflicting styles */
      .form-control.is-valid[type="text"],
      .form-control.is-valid[type="email"],
      .form-control.is-valid[type="password"],
      .form-control.is-invalid[type="text"],
      .form-control.is-invalid[type="email"],
      .form-control.is-invalid[type="password"] {
        color: #495057 !important;
        background-color: #ffffff !important;
        border-width: 2px;
      }

      /* Additional browser-specific fixes */
      .form-control {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
      }

      /* Ensure proper text rendering */
      .form-control {
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* Fix for Firefox */
      .form-control::-moz-placeholder {
        opacity: 1;
      }

      /* Fix for IE/Edge */
      .form-control::-ms-input-placeholder {
        opacity: 1;
      }

      /* Improved responsive design */
      @media (max-width: 576px) {
        .account-settings-title {
          font-size: 1.8rem;
        }

        .card-body {
          padding: 1rem;
        }

        .btn {
          width: 100%;
          margin-top: 1rem;
        }
      }

      /* Enhanced card styling */
      .card {
        background: linear-gradient(135deg, #ffffff, #f8f9fa);
        border: 1px solid rgba(0, 0, 0, 0.05);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }

      .card:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
      }

      /* Form section styling */
      .form-section {
        background: linear-gradient(135deg, #f8f9fa, #ffffff);
        border-radius: 1rem;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
      }

      /* Button group styling */
      .btn-group {
        display: flex;
        gap: 1rem;
        margin-top: 1.5rem;
      }

      @media (max-width: 768px) {
        .btn-group {
          flex-direction: column;
        }
      }
    </style>

    <style>
      /* Grid container for layout items */
      .grid-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      /* Individual grid item styling */
      .grid-item {
        background-color: #ffffff;
        /* Default background */
        /* border: 1px solid #e0e0e0; */
        /* Original border, removed for cleaner look with gradient */
        border-radius: 12px;
        padding: 20px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        position: relative;
        overflow: hidden;
        background: linear-gradient(135deg, #ffffff, #f0f8ff);
        /* Light gradient background */
        border: none;
        /* Ensure no border if using gradient */
      }

      /* Pseudo-element for hover effect background */
      .grid-item::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #0d6efd20, #6c757d20);
        /* Gradient overlay */
        z-index: -1;
        /* Behind content */
        transition: opacity 0.3s ease;
        opacity: 0;
        /* Hidden by default */
      }

      .grid-item:hover {
        transform: translateY(-5px);
        /* Slight lift on hover */
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        /* Enhanced shadow on hover */
      }

      .grid-item:hover::before {
        opacity: 1;
        /* Show gradient overlay on hover */
      }

      /* Grid item heading style (h3) */
      .grid-item h3 {
        font-size: 1.2rem;
        font-weight: bold;
        color: #333;
        margin-bottom: 10px;
        /* Spacing below heading */
      }

      /* Grid item icon style */
      .grid-item i {
        font-size: 2.5rem;
        /* Icon size */
        color: #0d6efd;
        /* Icon color */
        margin-bottom: 10px;
        /* Spacing below icon */
        display: block;
        /* Icon on its own line */
        transition: transform 0.3s ease;
        /* Animation for hover */
      }

      /* Grid item text (span) style */
      .grid-item span {
        font-size: 1.1rem;
        font-weight: bold;
        color: #333;
      }

      .grid-item:hover i {
        transform: scale(1.1);
        /* Enlarge icon on hover */
      }

      /* Table container with scrollbar */
      .table-container {
        max-height: 400px;
        overflow-y: auto;
        border: 1px solid #ddd;
        border-radius: 8px;
        margin-top: 20px;
      }

      /* Basic table styling */
      .table {
        width: 100%;
        border-collapse: collapse;
      }

      /* Table header (sticky) */
      .table thead {
        background-color: #f8f9fa;
        position: sticky;
        top: 0;
        z-index: 1;
        /* Keep header above scrolling content */
      }

      /* Table header cells and data cells */
      .table th,
      .table td {
        padding: 12px;
        text-align: center;
        border: 1px solid #ddd;
      }

      /* Table row hover effect */
      .table tbody tr:hover {
        background-color: #f1f1f1;
      }

      /* "Add" button styling */
      .btn-add {
        margin-bottom: 20px;
      }

      /* "Edit" button styling */
      .btn-edit {
        background-color: #ffc107;
        border-color: #ffc107;
      }

      /* "Delete" button styling */
      .btn-delete {
        background-color: #dc3545;
        border-color: #dc3545;
      }

      /* Utility class to hide elements */
      .hidden {
        display: none;
      }

      /* Modal content styling */
      .modal-content {
        border-radius: 16px;
        border: none;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        animation: fadeIn 0.3s ease-in-out;
        /* Fade-in animation */
      }

      /* Modal header styling */
      .modal-header {
        background: linear-gradient(135deg, #0d6efd, #1a73e8);
        color: #fff;
        border-radius: 16px 16px 0 0;
        /* Rounded top corners */
        padding: 15px 20px;
      }

      /* Modal title styling */
      .modal-title {
        font-size: 1.5rem;
        font-weight: bold;
        margin: 0;
      }

      /* Modal body styling */
      .modal-body {
        padding: 20px;
      }

      /* Modal footer styling */
      .modal-footer {
        border-top: 1px solid #e0e0e0;
        padding: 15px 20px;
        border-radius: 0 0 16px 16px;
        /* Rounded bottom corners */
      }

      /* Modal close button styling */
      .btn-close {
        background: #fff;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
      }

      .btn-close:hover {
        background: #f0f0f0;
        transform: scale(1.1);
      }

      /* Fade-in animation keyframes */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Dynamic background colors for grid items (example colors) */
      .grid-item:nth-child(1) {
        background-color: #e8f5e9;
      }

      /* Light Green */
      .grid-item:nth-child(2) {
        background-color: #fff3e0;
      }

      /* Light Orange */
      .grid-item:nth-child(3) {
        background-color: #e3f2fd;
      }

      /* Light Blue */
      .grid-item:nth-child(4) {
        background-color: #ffebee;
      }

      /* Light Red */
      .grid-item:nth-child(5) {
        background-color: #f3e5f5;
      }

      /* Light Purple */
      .grid-item:nth-child(6) {
        background-color: #e0f7fa;
      }

      /* Light Cyan */
      .grid-item:nth-child(7) {
        background-color: #ede7f6;
      }

      /* Another Light Purple */
      .grid-item:nth-child(8) {
        background-color: #fffde7;
      }

      /* Light Yellow */
      .grid-item:nth-child(9) {
        background-color: #e8eaf6;
      }

      /* Light Indigo */
      .grid-item:nth-child(10) {
        background-color: #d1c4e9;
      }

      /* Medium Purple */
      .grid-item:nth-child(11) {
        background-color: #b2ebf2;
      }

      /* Aqua Blue */
      .grid-item:nth-child(12) {
        background-color: #ffecb3;
      }

      /* Light Gold */
      .grid-item:nth-child(13) {
        background-color: #c8e6c9;
      }

      /* Medium Green */
      .grid-item:nth-child(14) {
        background-color: #bbdefb;
      }

      /* Sky Blue */
    </style>
  </head>

  <body class="g-sidenav-show bg-gray-100">
    <!-- Header -->
    <header id="mainHeader">
      <div style="display: flex; align-items: center; gap: 10px">
        <img
          src="assets/img/aleppo.jfif"
          alt="Logo 1"
          class="header-logo"
          onclick="window.location.href = './welcome.html';"
          style="cursor: pointer"
          title="Aleppo Governorate"
        />
      </div>

      <div class="header-title text-center">
        <div class="title-ar">نظام إدارة المعلومات الحضرية _ مدينة حلب</div>
        <div class="title-en">
          Urban Information Management System - Aleppo City
        </div>
      </div>

      <div class="header-logos right-logos">
        <div class="menu-dropdown">
          <button
            class="menu-toggle"
            id="menuToggleBtn"
            onclick="toggleMenu()"
          ></button>
          <div class="menu-dropdown-content" id="menuDropdown">
            <a
              href="#"
              class="menu-item"
              id="langToggleBtn"
              onclick="toggleLanguage();"
            >
              <i class="fas fa-language"></i>
              <span id="langToggleText">تغيير اللغة</span>
            </a>
            <a
              href="#"
              class="menu-item"
              id="logoutBtn"
              onclick="logoutUser();"
            >
              <i class="fas fa-sign-out-alt"></i>
              <span id="logoutText">تسجيل الخروج</span>
            </a>
          </div>
        </div>
          <img
            src="assets/img/unhabitat.png"
            alt="Logo 3"
            class="header-logo"
            title="UN Habitat"
            style="background-color: #fff;"
          />
        <img src="assets/img/japan.jpg" alt="Logo 2" class="header-logo" title="From the People of Japanese "/>
      </div>
    </header>

    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <!-- Main Content Area -->
    <main
      class="main-content position-relative max-height-vh-100 h-100 border-radius-lg"
      style="background: linear-gradient(135deg, #f8f9fa, #e9ecef)"
    >
      <!-- Profile Information Section -->
      <div class="container-fluid py-7">
        <div class="row">
          <!-- End User Profile Card -->
        </div>

        <!-- Account Settings Section -->
        <div class="row mt-4">
          <div class="col-md-12">
            <div
              class="card"
              style="
                padding: 50px;
                border-radius: 1.5rem;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
              "
            >
              <h6
                class="account-settings-title font-weight-bold mb-3"
                id="accountSettingsTitle"
              >
                إعدادات الحساب
              </h6>

              <!-- Profile Information Form -->
              <form id="profileForm">
                <h6 class="mb-3" id="personalInfoTitle">المعلومات الشخصية</h6>
                <div class="row">
                  <div class="col-md-6">
                    <label
                      for="firstName"
                      class="form-label"
                      id="firstNameLabel"
                      >الاسم الأول</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="firstName"
                      placeholder="أدخل الاسم الأول"
                    />
                    <div class="invalid-feedback" id="firstNameFeedback"></div>
                  </div>
                  <div class="col-md-6">
                    <label for="lastName" class="form-label" id="lastNameLabel"
                      >الاسم الأخير</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="lastName"
                      placeholder="أدخل الاسم الأخير"
                    />
                    <div class="invalid-feedback" id="lastNameFeedback"></div>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-md-6">
                    <label for="username" class="form-label" id="usernameLabel"
                      >اسم المستخدم</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="username"
                      placeholder="أدخل اسم المستخدم"
                    />
                    <div class="invalid-feedback" id="usernameFeedback"></div>
                  </div>
                  <div class="col-md-6">
                    <label for="email" class="form-label" id="emailLabel"
                      >البريد الإلكتروني</label
                    >
                    <input
                      type="email"
                      class="form-control"
                      id="email"
                      placeholder="أدخل بريدك الإلكتروني"
                      readonly
                    />
                    <small class="text-muted" id="emailNote"
                      >لا يمكن تغيير البريد الإلكتروني</small
                    >
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-md-6">
                    <label
                      for="fatherName"
                      class="form-label"
                      id="fatherNameLabel"
                      >اسم الأب</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="fatherName"
                      placeholder="أدخل اسم الأب"
                    />
                  </div>
                  <div class="col-md-6">
                    <label for="notes" class="form-label" id="notesLabel"
                      >ملاحظات</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="notes"
                      placeholder="ملاحظات إضافية"
                    />
                  </div>
                </div>
                <div class="mt-3">
                  <button
                    type="submit"
                    class="btn btn-success"
                    id="updateProfileBtn"
                  >
                    <span id="updateProfileText">تحديث المعلومات</span>
                  </button>
                </div>
              </form>

              <!-- Password Change Section -->
              <div class="password-section">
                <h6 class="mb-3" id="changePasswordTitle">تغيير كلمة المرور</h6>
                <form id="passwordForm">
                  <div class="row">
                    <div class="col-md-12">
                      <label
                        for="currentPassword"
                        class="form-label"
                        id="currentPasswordLabel"
                        >كلمة المرور الحالية</label
                      >
                      <input
                        type="password"
                        class="form-control"
                        id="currentPassword"
                        placeholder="أدخل كلمة المرور الحالية"
                        required
                      />
                      <div
                        class="invalid-feedback"
                        id="currentPasswordFeedback"
                      ></div>
                    </div>
                  </div>
                  <div class="row mt-3">
                    <div class="col-md-6">
                      <label
                        for="newPassword"
                        class="form-label"
                        id="newPasswordLabel"
                        >كلمة المرور الجديدة</label
                      >
                      <input
                        type="password"
                        class="form-control"
                        id="newPassword"
                        placeholder="أدخل كلمة المرور الجديدة"
                        required
                      />
                      <div
                        class="invalid-feedback"
                        id="newPasswordFeedback"
                      ></div>
                      <small class="text-muted" id="passwordHint"
                        >كلمة المرور يجب أن تكون 6 أحرف على الأقل</small
                      >
                    </div>
                    <div class="col-md-6">
                      <label
                        for="confirmNewPassword"
                        class="form-label"
                        id="confirmNewPasswordLabel"
                        >تأكيد كلمة المرور الجديدة</label
                      >
                      <input
                        type="password"
                        class="form-control"
                        id="confirmNewPassword"
                        placeholder="أعد إدخال كلمة المرور الجديدة"
                        required
                      />
                      <div
                        class="invalid-feedback"
                        id="confirmNewPasswordFeedback"
                      ></div>
                    </div>
                  </div>
                  <div class="mt-3">
                    <button
                      type="submit"
                      class="btn btn-warning"
                      id="changePasswordBtn"
                    >
                      <span id="changePasswordText">تغيير كلمة المرور</span>
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
        <!-- End Account Settings Section -->
      </div>
      <!-- End Profile Information Section -->
    </main>
    <!-- End Main Content Area -->

    <!-- Custom Page Scripts -->
    <script>
      // Page-specific variables
      let currentUser = null;

      // Enhanced notification system - use common functions if available
      function showNotification(type, message, title = null) {
        const container = document.getElementById("notificationContainer");
        if (!container) return;

        // Get localized title if not provided
        if (!title) {
          const t = translations[currentLang].notifications;
          title = t.titles[type] || t.titles.info;
        }

        // Create notification element
        const notification = document.createElement("div");
        notification.className = `notification ${type}`;

        // Get appropriate icon
        const icons = {
          success: "✓",
          error: "✕",
          warning: "⚠",
          info: "ℹ",
        };

        notification.innerHTML = `
          <div class="notification-icon">${icons[type] || icons.info}</div>
          <div class="notification-content">
            <div class="notification-title">${title}</div>
            <div class="notification-message">${message}</div>
          </div>
          <button class="notification-close" onclick="closeNotification(this.parentElement)">×</button>
        `;

        container.appendChild(notification);

        // Trigger animation
        setTimeout(() => notification.classList.add("show"), 10);

        // Auto remove after 5 seconds
        setTimeout(() => closeNotification(notification), 5000);
      }

      function closeNotification(notification) {
        if (!notification || !notification.parentElement) return;

        notification.classList.remove("show");
        notification.classList.add("hide");

        setTimeout(() => {
          if (notification.parentElement) {
            notification.remove();
          }
        }, 300);
      }

      // Helper functions for different notification types
      function showSuccessNotification(message, title = null) {
        showNotification("success", message, title);
      }

      function showErrorNotification(message, title = null) {
        showNotification("error", message, title);
      }

      function showWarningNotification(message, title = null) {
        showNotification("warning", message, title);
      }

      function showInfoNotification(message, title = null) {
        showNotification("info", message, title);
      }

      // Load user profile
      async function loadUserProfile(showNotification = false) {
        try {
          // Get user data from localStorage
          const userData = localStorage.getItem("user");
          if (userData) {
            currentUser = JSON.parse(userData);
            displayUserProfile(currentUser);

            // Show success notification only if requested
            if (showNotification) {
              const t = translations[currentLang].notifications;
              showSuccessNotification(t.profileLoaded);
            }
          } else {
            // If no user data, create default user
            currentUser = {
              id: 1,
              username: "user",
              email: "user@example.com",
              first_name: "مستخدم",
              last_name: "افتراضي",
              father_name: "",
              notes: "",
              is_active: true,
              date_joined: new Date().toISOString()
            };
            displayUserProfile(currentUser);
          }
        } catch (error) {
          console.error("Error loading profile:", error);
          const t = translations[currentLang].notifications;
          showErrorNotification(t.profileLoadFailed + ": " + error.message);
        }
      }

      // Display user profile
      function displayUserProfile(user) {
        // Hide loading and show content
        const loadingDiv = document.getElementById("profileLoading");
        if (loadingDiv) loadingDiv.style.display = "none";
        const contentDiv = document.getElementById("profileContent");
        if (contentDiv) contentDiv.style.display = "block";

        // Update profile display
        const usernameEl = document.getElementById("profileUsername");
        if (usernameEl) usernameEl.textContent = user.username;
        const emailEl = document.getElementById("profileEmail");
        if (emailEl) emailEl.textContent = user.email || "غير محدد";
        const joinDateEl = document.getElementById("profileJoinDate");
        if (joinDateEl && user.date_joined) {
          const joinDate = new Date(user.date_joined).toLocaleDateString(
            currentLang === "ar" ? "ar-SA" : "en-US"
          );
          const t = translations[currentLang];
          joinDateEl.textContent = `${t.joinedDate} ${joinDate}`;
        }

        // Fill form fields
        const firstNameEl = document.getElementById("firstName");
        if (firstNameEl) firstNameEl.value = user.first_name || "";
        const lastNameEl = document.getElementById("lastName");
        if (lastNameEl) lastNameEl.value = user.last_name || "";
        const usernameInputEl = document.getElementById("username");
        if (usernameInputEl) usernameInputEl.value = user.username || "";
        const emailInputEl = document.getElementById("email");
        if (emailInputEl) emailInputEl.value = user.email || "";
        const fatherNameEl = document.getElementById("fatherName");
        if (fatherNameEl) fatherNameEl.value = user.father_name || "";
        const notesEl = document.getElementById("notes");
        if (notesEl) notesEl.value = user.notes || "";

        // Apply current language translations
        const t = translations[currentLang];
        updateProfileTranslations(t);
      }

      // Update profile information
      async function updateProfile(formData) {
        try {
          const t = translations[currentLang].notifications;
          showInfoNotification(t.profileUpdating);

          // Update user data in localStorage
          currentUser = { ...currentUser, ...formData };
          localStorage.setItem("user", JSON.stringify(currentUser));
          localStorage.setItem("userInfo", JSON.stringify(currentUser));

          // Show success notification
          showSuccessNotification(t.profileUpdated);
          
          // Update display
          displayUserProfile(currentUser);
        } catch (error) {
          console.error("Error updating profile:", error);
          const t = translations[currentLang].notifications;
          showErrorNotification(t.profileUpdateFailed + ": " + error.message);
        }
      }

      // Change password
      async function changePassword(oldPassword, newPassword) {
        try {
          const t = translations[currentLang].notifications;
          showInfoNotification(t.passwordChanging);

          // Simulate password change (in real app, this would be validated)
          // For demo purposes, we'll just show success
          await new Promise(resolve => setTimeout(resolve, 1000));

          showSuccessNotification(t.passwordChanged);
          // Clear password fields
          document.getElementById("passwordForm").reset();
          clearValidationClasses();
        } catch (error) {
          console.error("Error changing password:", error);
          const t = translations[currentLang].notifications;
          showErrorNotification(t.passwordChangeFailed + ": " + error.message);
        }
      }

      // Validation functions
      function validateEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
      }

      function validatePassword(password) {
        return password.length >= 6;
      }

      function showFieldError(fieldId, message) {
        const field = document.getElementById(fieldId);
        const feedback = document.getElementById(fieldId + "Feedback");

        field.classList.remove("is-valid");
        field.classList.add("is-invalid");

        // Ensure text remains visible
        field.style.color = "#495057";
        field.style.backgroundColor = "#ffffff";

        if (feedback) {
          feedback.textContent = message;
        }
      }

      function showFieldSuccess(fieldId) {
        const field = document.getElementById(fieldId);
        const feedback = document.getElementById(fieldId + "Feedback");

        field.classList.remove("is-invalid");
        field.classList.add("is-valid");

        // Ensure text remains visible
        field.style.color = "#495057";
        field.style.backgroundColor = "#ffffff";

        if (feedback) {
          feedback.textContent = "";
        }
      }

      function clearValidationClasses() {
        document
          .querySelectorAll(".is-invalid, .is-valid")
          .forEach((element) => {
            element.classList.remove("is-invalid", "is-valid");
            // Reset inline styles to ensure text visibility
            element.style.color = "#495057";
            element.style.backgroundColor = "#ffffff";
          });
        document
          .querySelectorAll(".invalid-feedback, .valid-feedback")
          .forEach((element) => {
            element.textContent = "";
          });
      }

      // Localized validation messages
      function getLocalizedMessage(key) {
        const messages = {
          ar: {
            firstNameRequired: "الاسم الأول مطلوب",
            lastNameRequired: "الاسم الأخير مطلوب",
            usernameRequired: "اسم المستخدم مطلوب",
            currentPasswordRequired: "كلمة المرور الحالية مطلوبة",
            newPasswordRequired: "كلمة المرور الجديدة مطلوبة",
            confirmPasswordRequired: "تأكيد كلمة المرور مطلوب",
            passwordTooShort: "كلمة المرور يجب أن تكون 6 أحرف على الأقل",
            passwordMismatch: "كلمة المرور غير متطابقة",
          },
          en: {
            firstNameRequired: "First name is required",
            lastNameRequired: "Last name is required",
            usernameRequired: "Username is required",
            currentPasswordRequired: "Current password is required",
            newPasswordRequired: "New password is required",
            confirmPasswordRequired: "Confirm password is required",
            passwordTooShort: "Password must be at least 6 characters",
            passwordMismatch: "Passwords do not match",
          },
        };
        return messages[currentLang][key] || key;
      }

      // Initialize custom scrollbar for Windows platforms
      var win = navigator.platform.indexOf("Win") > -1;
      if (win && document.querySelector("#sidenav-scrollbar")) {
        var options = {
          damping: "0.5",
        };
        Scrollbar.init(document.querySelector("#sidenav-scrollbar"), options);
      }
    </script>
    <script>
      // Script for modal events (example: display data when modal is shown)
      document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll(".modal").forEach((modal) => {
          modal.addEventListener("show.bs.modal", function (event) {
            // Log when a modal is opened
            console.log(`Modal opened: ${this.id}`);
            const tableName = this.getAttribute("data-table");
            if (tableName) {
              // Log the table name if it exists and call displayData
              console.log(`Displaying data for table: ${tableName}`);
              // displayData(tableName); // Ensure displayData function is defined elsewhere or remove if not used
            }
          });
        });
      });
    </script>

    <script>
      // Wait for DOM to be fully loaded
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize language based on preference
        try {
          const savedLang = localStorage.getItem("preferredLanguage") || "en";
          currentLang = savedLang;
          // Update the span text inside the button, not the button itself
          const langToggleText = document.getElementById("langToggleText");
          if (langToggleText) {
            langToggleText.textContent = currentLang === "ar" ? "تغيير اللغة" : "Change Language";
          }
          switchLanguage(savedLang);
        } catch (error) {
          console.error("Error loading language preference:", error);
          switchLanguage("en");
        }

        // Load user profile safely
        if (typeof loadUserProfile === "function") {
          loadUserProfile();
        }

        // Ensure form controls have proper styling on load
        document.querySelectorAll(".form-control").forEach(function (input) {
          input.style.color = "#495057";
          input.style.backgroundColor = "#ffffff";
        });

        // Add event listeners to ensure text visibility on input
        document.querySelectorAll(".form-control").forEach(function (input) {
          input.addEventListener("input", function () {
            this.style.color = "#495057";
            this.style.backgroundColor = "#ffffff";
          });

          input.addEventListener("focus", function () {
            this.style.color = "#495057";
            this.style.backgroundColor = "#ffffff";
          });

          input.addEventListener("blur", function () {
            this.style.color = "#495057";
            this.style.backgroundColor = "#ffffff";
          });
        });

        // Profile form submission
        document
          .getElementById("profileForm")
          .addEventListener("submit", async function (e) {
            e.preventDefault();

            // Clear previous validations
            clearValidationClasses();

            // Get form data
            const firstName = document.getElementById("firstName").value.trim();
            const lastName = document.getElementById("lastName").value.trim();
            const username = document.getElementById("username").value.trim();
            const email = document.getElementById("email").value.trim(); // readonly field
            const fatherName = document
              .getElementById("fatherName")
              .value.trim();
            const notes = document.getElementById("notes").value.trim();

            let isValid = true;

            // Validate required fields
            if (!firstName) {
              showFieldError(
                "firstName",
                getLocalizedMessage("firstNameRequired")
              );
              isValid = false;
            } else {
              showFieldSuccess("firstName");
            }

            if (!lastName) {
              showFieldError(
                "lastName",
                getLocalizedMessage("lastNameRequired")
              );
              isValid = false;
            } else {
              showFieldSuccess("lastName");
            }

            if (!username) {
              showFieldError(
                "username",
                getLocalizedMessage("usernameRequired")
              );
              isValid = false;
            } else {
              showFieldSuccess("username");
            }

            // Email is readonly, no validation needed

            if (!isValid) {
              const t = translations[currentLang].notifications;
              showWarningNotification(t.validationError);
              return;
            }

            // Update profile (including username, excluding email as it's readonly)
            await updateProfile({
              username: username,
              first_name: firstName,
              last_name: lastName,
              father_name: fatherName,
              notes: notes,
            });
          });

        // Password form submission
        document
          .getElementById("passwordForm")
          .addEventListener("submit", async function (e) {
            e.preventDefault();

            // Clear previous validations
            clearValidationClasses();

            // Get form data
            const currentPassword =
              document.getElementById("currentPassword").value;
            const newPassword = document.getElementById("newPassword").value;
            const confirmNewPassword =
              document.getElementById("confirmNewPassword").value;

            let isValid = true;

            // Validate current password
            if (!currentPassword) {
              showFieldError(
                "currentPassword",
                getLocalizedMessage("currentPasswordRequired")
              );
              isValid = false;
            } else {
              showFieldSuccess("currentPassword");
            }

            // Validate new password
            if (!newPassword) {
              showFieldError(
                "newPassword",
                getLocalizedMessage("newPasswordRequired")
              );
              isValid = false;
            } else if (!validatePassword(newPassword)) {
              showFieldError(
                "newPassword",
                getLocalizedMessage("passwordTooShort")
              );
              isValid = false;
            } else {
              showFieldSuccess("newPassword");
            }

            // Validate password confirmation
            if (!confirmNewPassword) {
              showFieldError(
                "confirmNewPassword",
                getLocalizedMessage("confirmPasswordRequired")
              );
              isValid = false;
            } else if (newPassword !== confirmNewPassword) {
              showFieldError(
                "confirmNewPassword",
                getLocalizedMessage("passwordMismatch")
              );
              isValid = false;
            } else {
              showFieldSuccess("confirmNewPassword");
            }

            if (!isValid) {
              const t = translations[currentLang].notifications;
              showWarningNotification(t.validationError);
              return;
            }

            // Change password
            await changePassword(currentPassword, newPassword);
          });
      });
    </script>

    <!-- Language Toggle and Menu Script -->
    <script>
      // Object containing translations for Arabic and English
      const translations = {
        ar: {
          dir: "rtl",
          dashboard: "لوحة التحكم",
          configTables: "جداول الإعدادات",
          maps: "الخرائط",
          manageUsers: "إدارة المستخدمين ",
          signIn: "تسجيل الدخول",
          signUp: "إنشاء حساب",
          families: "عدد الأسر",
          validBuildings: "منشآت صالحة",
          residentialBuildings: "منشآت سكنية",
          threatened: "مهددة بالإزالة",
          constructionStatus: "الوضع الإنشائي",
          educationStatus: "الوضع التعليمي",
          healthStatus: "الوضع الصحي",
          footerText: "© 2025، جميع الحقوق محفوظة،",
          companyName: "دار التقنية الحديثة",

          activeProjects: "مشاريع نشطة",
          completedTasks: "مهام مكتملة",
          uploadedFiles: "ملفات مرفوعة",
          accountSettings: "إعدادات الحساب",
          username: "اسم المستخدم",
          email: "البريد الإلكتروني",
          newPassword: "كلمة المرور الجديدة",
          confirmPassword: "تأكيد كلمة المرور",
          enterNewPassword: "أدخل كلمة المرور الجديدة",
          reenterPassword: "أعد إدخال كلمة المرور",
          saveChanges: "حفظ التغييرات",
          langToggleText: "تغيير اللغة",
          logoutText: "تسجيل الخروج",
          neighborhoodCommittees: "إدارة لجان الأحياء",
          developmentCommittees: "إدارة لجان التنمية والتطوع",
          enterYourName: "أدخل اسم المستخدم",
          enterYourEmail: "أدخل بريدك الإلكتروني",
          // Profile page translations
          personalInfo: "المعلومات الشخصية",
          firstName: "الاسم الأول",
          lastName: "الاسم الأخير",
          fatherName: "اسم الأب",
          notes: "ملاحظات",
          updateInfo: "تحديث المعلومات",
          changePassword: "تغيير كلمة المرور",
          currentPassword: "كلمة المرور الحالية",
          newPasswordLabel: "كلمة المرور الجديدة",
          confirmNewPassword: "تأكيد كلمة المرور الجديدة",
          enterFirstName: "أدخل الاسم الأول",
          enterLastName: "أدخل الاسم الأخير",
          enterFatherName: "أدخل اسم الأب",
          enterNotes: "ملاحظات إضافية",
          enterCurrentPassword: "أدخل كلمة المرور الحالية",
          enterNewPassword: "أدخل كلمة المرور الجديدة",
          confirmPasswordPlaceholder: "أعد إدخال كلمة المرور الجديدة",
          passwordHint: "كلمة المرور يجب أن تكون 6 أحرف على الأقل",
          emailNote: "لا يمكن تغيير البريد الإلكتروني",
          joinedDate: "انضم في:",
          loading: "جاري التحميل...",

          // Notification system
          notifications: {
            titles: {
              success: "نجح العملية",
              error: "خطأ",
              warning: "تحذير",
              info: "معلومات",
            },
            profileLoaded: "تم تحميل الملف الشخصي بنجاح",
            profileLoadFailed: "فشل في تحميل الملف الشخصي",
            profileUpdating: "جاري تحديث الملف الشخصي...",
            profileUpdated: "تم تحديث الملف الشخصي بنجاح",
            profileUpdateFailed: "فشل في تحديث الملف الشخصي",
            passwordChanging: "جاري تغيير كلمة المرور...",
            passwordChanged: "تم تغيير كلمة المرور بنجاح",
            passwordChangeFailed: "فشل في تغيير كلمة المرور",
            sessionExpired: "انتهت صلاحية الجلسة، يرجى تسجيل الدخول مرة أخرى",
            validationError: "خطأ في البيانات",
            networkError: "خطأ في الاتصال",
          },
        },
        en: {
          neighborhoodCommittees: "Neighborhood Comm",
          developmentCommittees: "Development Comm",
          dir: "ltr",
          dashboard: "Dashboard",
          configTables: "Configuration Tables",
          maps: "Maps",
          manageUsers: "Manage Users",
          signIn: "Sign In",
          signUp: "Sign Up",
          families: "Families",
          validBuildings: "Valid Buildings",
          residentialBuildings: "Residential Buildings",
          threatened: "Threatened with Removal",
          constructionStatus: "Construction Status",
          educationStatus: "Education Status",
          healthStatus: "Health Status",
          footerText: "© 2025, All rights reserved,",
          companyName: "Hi-Tech House",

          activeProjects: "Active Projects",
          completedTasks: "Completed Tasks",
          uploadedFiles: "Uploaded Files",
          accountSettings: "Account Settings",
          username: "Username",
          email: "Email",
          newPassword: "New Password",
          confirmPassword: "Confirm Password",
          enterNewPassword: "Enter new password",
          reenterPassword: "Re-enter password",
          saveChanges: "Save Changes",
          langToggleText: "Change Language",
          logoutText: "Logout",
          enterYourName: "enter your name",
          enterYourEmail: "enter your email",
          // Profile page translations
          personalInfo: "Personal Information",
          firstName: "First Name",
          lastName: "Last Name",
          fatherName: "Father Name",
          notes: "Notes",
          updateInfo: "Update Information",
          changePassword: "Change Password",
          currentPassword: "Current Password",
          newPasswordLabel: "New Password",
          confirmNewPassword: "Confirm New Password",
          enterFirstName: "Enter first name",
          enterLastName: "Enter last name",
          enterFatherName: "Enter father name",
          enterNotes: "Additional notes",
          enterCurrentPassword: "Enter current password",
          enterNewPassword: "Enter new password",
          confirmPasswordPlaceholder: "Re-enter new password",
          passwordHint: "Password must be at least 6 characters",
          emailNote: "Email cannot be changed",
          joinedDate: "Joined:",
          loading: "Loading...",

          // Notification system
          notifications: {
            titles: {
              success: "Success",
              error: "Error",
              warning: "Warning",
              info: "Information",
            },
            profileLoaded: "Profile loaded successfully",
            profileLoadFailed: "Failed to load profile",
            profileUpdating: "Updating profile...",
            profileUpdated: "Profile updated successfully",
            profileUpdateFailed: "Failed to update profile",
            passwordChanging: "Changing password...",
            passwordChanged: "Password changed successfully",
            passwordChangeFailed: "Failed to change password",
            sessionExpired: "Session expired, please login again",
            validationError: "Validation error",
            networkError: "Network error",
          },
        },
      };

      let currentLang = "en"; // Default language

      // Function to switch the language of the page
      function switchLanguage(lang) {
        // Store the language preference in localStorage
        try {
          localStorage.setItem("preferredLanguage", lang);
        } catch (error) {
          console.error("Error saving language preference:", error);
        }

        // Update aside (sidebar) position based on language
        const aside = document.getElementById("sidenav-main");
        if (aside) {
          aside.classList.remove("fixed-end", "fixed-start");
          if (lang === "ar") {
            aside.classList.add("fixed-end");
          } else {
            aside.classList.add("fixed-start");
          }
        }

        currentLang = lang;
        const t = translations[lang];

        // Update document direction and language attribute
        document.documentElement.lang = lang;
        document.documentElement.dir = t.dir;

        // Update text content of navigation links in the sidebar
        const navTexts = document.querySelectorAll(".nav-link .nav-link-text");
        if (navTexts.length > 0) {
          if (navTexts[0]) navTexts[0].textContent = t.dashboard;
          if (navTexts[1]) navTexts[1].textContent = t.configTables;
          if (navTexts[2]) navTexts[2].textContent = t.manageUsers;
          if (navTexts[3]) navTexts[3].textContent = t.neighborhoodCommittees;
          if (navTexts[4]) navTexts[4].textContent = t.standards;
          if (navTexts[4]) navTexts[4].textContent = t.developmentCommittees;
        }

        // Update profile section specific texts

        const formLabels = document.querySelectorAll(
          ".settings-card .form-label"
        );
        if (formLabels.length >= 4) {
          // Check if all form labels are present
          formLabels[0].textContent = t.username;
          formLabels[1].textContent = t.email;
          formLabels[2].textContent = t.newPassword;
          formLabels[3].textContent = t.confirmPassword;
        }

        const passwordInputs = document.querySelectorAll(
          '.settings-card input[type="password"]'
        );
        if (passwordInputs.length >= 2) {
          // Check if password inputs are present
          passwordInputs[0].placeholder = t.enterNewPassword;
          passwordInputs[1].placeholder = t.reenterPassword;
        }

        const saveButton = document.querySelector(
          ".settings-card .btn-success"
        );
        if (saveButton) saveButton.textContent = t.saveChanges;

        // Update menu item texts
        const langToggleText = document.getElementById("langToggleText");
        if (langToggleText) langToggleText.textContent = t.langToggleText;

        const logoutMenuText = document.getElementById("logoutText");
        if (logoutMenuText) logoutMenuText.textContent = t.logoutText;

        // تحديث الـ placeholder لحقول الاسم والبريد الإلكتروني
        const usernameInput = document.getElementById("username");
        if (usernameInput) usernameInput.placeholder = t.enterYourName;
        const emailInput = document.getElementById("email");
        if (emailInput) emailInput.placeholder = t.enterYourEmail;

        // Update Profile page specific elements
        updateProfileTranslations(t);
      }

      // Function to update Profile page translations
      function updateProfileTranslations(t) {
        // Loading text
        const loadingText = document.querySelector("#profileLoading p");
        if (loadingText) loadingText.textContent = t.loading;

        // Joined date format - only update if currentUser is available
        try {
          const user =
            currentUser || window.userFunctions?.currentUserProfile();
          if (user && user.date_joined) {
            const joinDate = new Date(user.date_joined).toLocaleDateString(
              currentLang === "ar" ? "ar-SA" : "en-US"
            );
            const profileJoinDate = document.getElementById("profileJoinDate");
            if (profileJoinDate) {
              profileJoinDate.textContent = `${t.joinedDate} ${joinDate}`;
            }
          }
        } catch (error) {
          console.log("User profile not yet loaded, skipping date update");
        }

        // Form titles
        const accountSettingsTitle = document.getElementById(
          "accountSettingsTitle"
        );
        if (accountSettingsTitle)
          accountSettingsTitle.textContent = t.accountSettings;

        const personalInfoTitle = document.getElementById("personalInfoTitle");
        if (personalInfoTitle) personalInfoTitle.textContent = t.personalInfo;

        const changePasswordTitle = document.getElementById(
          "changePasswordTitle"
        );
        if (changePasswordTitle)
          changePasswordTitle.textContent = t.changePassword;

        // Form labels
        const firstNameLabel = document.getElementById("firstNameLabel");
        if (firstNameLabel) firstNameLabel.textContent = t.firstName;

        const lastNameLabel = document.getElementById("lastNameLabel");
        if (lastNameLabel) lastNameLabel.textContent = t.lastName;

        const usernameLabel = document.getElementById("usernameLabel");
        if (usernameLabel) usernameLabel.textContent = t.username;

        const emailLabel = document.getElementById("emailLabel");
        if (emailLabel) emailLabel.textContent = t.email;

        const fatherNameLabel = document.getElementById("fatherNameLabel");
        if (fatherNameLabel) fatherNameLabel.textContent = t.fatherName;

        const notesLabel = document.getElementById("notesLabel");
        if (notesLabel) notesLabel.textContent = t.notes;

        const currentPasswordLabel = document.getElementById(
          "currentPasswordLabel"
        );
        if (currentPasswordLabel)
          currentPasswordLabel.textContent = t.currentPassword;

        const newPasswordLabel = document.getElementById("newPasswordLabel");
        if (newPasswordLabel) newPasswordLabel.textContent = t.newPasswordLabel;

        const confirmNewPasswordLabel = document.getElementById(
          "confirmNewPasswordLabel"
        );
        if (confirmNewPasswordLabel)
          confirmNewPasswordLabel.textContent = t.confirmNewPassword;

        // Form placeholders
        const firstNameInput = document.getElementById("firstName");
        if (firstNameInput) firstNameInput.placeholder = t.enterFirstName;

        const lastNameInput = document.getElementById("lastName");
        if (lastNameInput) lastNameInput.placeholder = t.enterLastName;

        const fatherNameInput = document.getElementById("fatherName");
        if (fatherNameInput) fatherNameInput.placeholder = t.enterFatherName;

        const notesInput = document.getElementById("notes");
        if (notesInput) notesInput.placeholder = t.enterNotes;

        const currentPasswordInput = document.getElementById("currentPassword");
        if (currentPasswordInput)
          currentPasswordInput.placeholder = t.enterCurrentPassword;

        const newPasswordInput = document.getElementById("newPassword");
        if (newPasswordInput) newPasswordInput.placeholder = t.enterNewPassword;

        const confirmNewPasswordInput =
          document.getElementById("confirmNewPassword");
        if (confirmNewPasswordInput)
          confirmNewPasswordInput.placeholder = t.confirmPasswordPlaceholder;

        // Button texts
        const updateProfileText = document.getElementById("updateProfileText");
        if (updateProfileText) updateProfileText.textContent = t.updateInfo;

        const changePasswordText =
          document.getElementById("changePasswordText");
        if (changePasswordText)
          changePasswordText.textContent = t.changePassword;

        // Help texts
        const passwordHint = document.getElementById("passwordHint");
        if (passwordHint) passwordHint.textContent = t.passwordHint;

        const emailNote = document.getElementById("emailNote");
        if (emailNote) emailNote.textContent = t.emailNote;
      }

      // Function to toggle between Arabic and English
      function toggleLanguage() {
        if (currentLang === "ar") {
          switchLanguage("en");
        } else {
          switchLanguage("ar");
        }
      }

      // Sets up initial language and event listeners when the DOM is fully loaded
      document.addEventListener("DOMContentLoaded", function () {
        // Check if there's a saved language preference in localStorage
        let savedLanguage;
        try {
          savedLanguage = localStorage.getItem("preferredLanguage");
        } catch (error) {
          console.error("Error retrieving language preference:", error);
          savedLanguage = null;
        }

        // Set initial language based on saved preference or default to Arabic
        const initialLang = savedLanguage || "ar"; // Default to Arabic if nothing is saved
        switchLanguage(initialLang);
      });

      // Function to toggle the visibility of the dropdown menu
      function toggleMenu() {
        const menu = document.getElementById("menuDropdown");
        menu.style.display = menu.style.display === "block" ? "none" : "block";
      }

      // Function to handle user logout
      function logout() {
        // Redirects the user to the login page (index.html)
        window.location.href = "./index.html";
      }

      // Closes the dropdown menu if a click occurs outside of it
      document.addEventListener("click", function (e) {
        const menu = document.getElementById("menuDropdown");
        const menuBtn = document.getElementById("menuToggleBtn");

        // Check if the click target is outside the menu button and the menu itself
        if (menu && menuBtn) {
          // Ensure elements exist
          if (!menuBtn.contains(e.target) && !menu.contains(e.target)) {
            menu.style.display = "none"; // Hide the menu
          }
        }
      });

      // Load user profile after all functions are defined
      if (typeof loadUserProfile === "function") {
        loadUserProfile();
      }

      // Function to handle user logout (for menu)
      function logoutUser() {
        // Clear localStorage
        localStorage.removeItem("user");
        localStorage.removeItem("userInfo");
        localStorage.removeItem("userPermissions");
        localStorage.removeItem("isLoggedIn");
        localStorage.removeItem("access_token");
        localStorage.removeItem("refresh_token");
        
        // Redirects the user to the login page (index.html)
        window.location.href = "./index.html";
      }
    </script>
  </body>
</html>
